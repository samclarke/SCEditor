(function(a,b,c){"use strict",a.sceditor.BBCodeParser=function(b){if(!(this instanceof a.sceditor.BBCodeParser))return new a.sceditor.BBCodeParser(b);var d=this,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t={open:"open",content:"content",newline:"newline",close:"close"};Object.freeze&&Object.freeze(t);var u=function(a,b,c,d,e,f){var g=this;g.type=a,g.name=b,g.val=c,g.attrs=d||{},g.children=e||[],g.closing=f||null};u.prototype={clone:function(a){var b=this;return new u(b.type,b.name,b.val,b.attrs,a?b.children:[],b.closing?b.closing.clone():null)},splitAt:function(b){var c,d=this,e=0,f=d.children.length;typeof object!="number"&&(b=a.inArray(b,d.children));if(b<0||b>f)return null;while(f--)f>=b?e++:f=!1;return c=d.clone(),c.children=d.children.splice(b,e),c}},e=function(){d.opts=a.extend({},a.sceditor.BBCodeParser.defaults,b),d.bbcodes=a.sceditor.plugins.bbcode.bbcodes},d.tokenize=function(a){var b,c,d,e=[],g=[{type:"close",regex:/^\[\/[^\[\]]+\]/},{type:"open",regex:/^\[[^\[\]]+\]/},{type:"newline",regex:/^(\r\n|\r|\n)/},{type:"content",regex:/^([^\[\r\n]+|\[)/}];g.reverse();a:while(a.length){d=g.length;while(d--){c=g[d].type;if(!(b=a.match(g[d].regex))||!b[0])continue;e.push(f(c,b[0])),a=a.substr(b[0].length);continue a}a.length&&e.push(f(t.content,a)),a=""}return e},f=function(b,c){var d,e,f;return b==="open"?(d=c.match(/\[([^\]\s=]+)(?:([^\]]+))?\]/),d?(f=r(d[1]),d[2]&&(d[2]=a.trim(d[2]))&&(e=g(d[2]))):(b="content",f="#")):b==="close"?(d=c.match(/\[\/([^\[\]]+)\]/),d?f=r(d[1]):(b="content",f="#")):b==="newline"?f="#newline":f="#",new u(b,f,c,e)},g=function(b){var c,d,e=/([^\s=]+)=(?:(?:(["'])((?:\\\2|[^\2])*?)\2)|((?:.(?!\s\S+=))*.))/g,f={};d=function(a,b){return b&&(a=a.replace("\\\\","\\").replace("\\"+b,b)),a};if(b.charAt(0)==="="&&b.split("=").length<=2)f.defaultattr=a.sceditor.plugins.bbcode.stripQuotes(b.substr(1));else{b.charAt(0)==="="&&(b="defaultattr"+b);while(c=e.exec(b))f[r(c[1])]=d(c[3],c[2])||c[4]}return f},d.parse=function(a,b){var c=h(d.tokenize(a));return d.opts.fixInvalidChildren&&m(c),d.opts.removeEmptyTags&&l(c),d.opts.fixInvalidNesting&&j(c),i(c,null,b),d.opts.removeEmptyTags&&l(c),c},p=function(a,b,c){var d=c.length;while(d--)if(c[d].type===b&&c[d].name===a)return!0;return!1},k=function(b,c){var e=b?d.bbcodes[b.name]:null,f=e?e.allowedChildren:null;return!d.opts.fixInvalidChildren||!f?!0:f&&a.inArray(c.name||"#",f)<0?!1:!0},h=function(b){var c,e,f,g,h,i,j,k=[],l=[],m=[],n=function(){return s(m)},o=function(a){n()?n().children.push(a):l.push(a)},q=function(b){return n()&&(e=d.bbcodes[n().name])&&e.closedBy&&a.inArray(b,e.closedBy)>-1};while(c=b.shift()){j=b[0];switch(c.type){case t.open:q(c.name)&&m.pop(),o(c),e=d.bbcodes[c.name],(!e||!e.isSelfClosing)&&(e||p(c.name,t.close,b))&&m.push(c);break;case t.close:n()&&c.name!==n().name&&q("/"+c.name)&&m.pop();if(n()&&c.name===n().name)n().closing=c,m.pop();else if(p(c.name,t.open,m)){while(f=m.pop()){if(f.name===c.name){f.closing=c;break}g=f.clone(),k.length>1&&g.children.push(s(k)),k.push(g)}o(s(k)),h=k.length;while(h--)m.push(k[h]);k.length=0}else c.type=t.content,o(c);break;case t.newline:n()&&j&&q((j.type===t.close?"/":"")+j.name)&&(j.type!==t.close||j.name!==n().name)&&(e=d.bbcodes[n().name],e&&e.breakAfter?m.pop():e&&e.isInline===!1&&d.opts.breakAfterBlock&&e.breakAfter!==!1&&m.pop()),o(c);break;default:o(c)}i=c}return l},i=function(a,b,c){var e,f,g,h,j,k,l,m,n,o=a.length,p=o;b&&(h=d.bbcodes[b.name]);while(p--){if(!(e=a[p]))continue;if(e.type===t.newline){f=p>0?a[p-1]:null,g=p<o-1?a[p+1]:null,n=!1,!c&&h&&h.isSelfClosing!==!0&&(p===0?(h.isInline===!1&&d.opts.breakStartBlock&&h.breakStart!==!1&&(n=!0),h.breakStart&&(n=!0)):!l&&o-1===p&&(h.isInline===!1&&d.opts.breakEndBlock&&h.breakEnd!==!1&&(n=!0),h.breakEnd&&(n=!0),l=n)),f&&f.type===t.open&&(j=d.bbcodes[f.name])&&(c?j.isInline===!1&&(n=!0):(j.isInline===!1&&d.opts.breakAfterBlock&&j.breakAfter!==!1&&(n=!0),j.breakAfter&&(n=!0)));if(!c&&!m&&g&&g.type===t.open)if(k=d.bbcodes[g.name]){k.isInline===!1&&d.opts.breakBeforeBlock&&k.breakBefore!==!1&&(n=!0),k.breakBefore&&(n=!0),m=n;if(n){a.splice(p,1);continue}}n&&a.splice(p,1),m=!1}else e.type===t.open&&i(e.children,e,c)}},j=function(b,c,e,f){var g,h,i,k,l,m,n=function(a){var b=d.bbcodes[a.name];return!b||b.isInline!==!1};c=c||[],f=f||b;for(h=0;h<b.length;h++){if(!(g=b[h])||g.type!==t.open)continue;if(!n(g)&&e){i=s(c),m=i.splitAt(g),l=c.length>1?c[c.length-2].children:f;if((k=a.inArray(i,l))>-1){m.children.splice(a.inArray(g,m.children),1),l.splice(k+1,0,g,m);return}}c.push(g),j(g.children,c,e||n(g),f),c.pop(g)}},m=function(a,b){var c,d,e=a.length;while(e--){if(!(c=a[e]))continue;k(b,c)||(c.name=null,c.type=t.content,k(b,c)?(d=[e+1,0].concat(c.children),c.closing&&(c.closing.name=null,c.closing.type=t.content,d.push(c.closing)),e+=d.length-1,Array.prototype.splice.apply(a,d)):b.children.splice(e,1)),c.type===t.open&&m(c.children,c)}},l=function(a){var b,c,e,f=a.length;e=function(a){var b=a.length;while(b--){if(a[b].type===t.open)return!1;if(a[b].type===t.close)return!1;if(a[b].type===t.content&&a[b].val&&/\S|\u00A0/.test(a[b].val))return!1}return!0};while(f--){if(!(b=a[f])||b.type!==t.open)continue;c=d.bbcodes[b.name],l(b.children),e(b.children)&&c&&!c.isSelfClosing&&!c.allowsEmpty&&a.splice(f,1)}},d.toHTML=function(a,b){return n(d.parse(a,b),!0)},n=function(b,e){var f,g,h,i,j,k,l,m,o=[];while(b.length>0){if(!(f=b.shift()))continue;if(f.type===t.open)g=d.bbcodes[f.name],l=!g||(typeof g.isHtmlInline!="undefined"?g.isHtmlInline:g.isInline),j=e&&(!g||l!==!1),h=n(f.children,!1),g&&g.html?(m=l===!1&&!g.isPreFormatted&&!g.skipLastLineBreak,m&&!a.sceditor.ie&&(h+="<br />"),a.isFunction(g.html)?i=g.html.call(d,f,f.attrs,h):i=a.sceditor.plugins.bbcode.formatString(g.html,h)):i=f.val+h+(f.closing?f.closing.val:"");else{if(f.type===t.newline){if(!e){o.push("<br />");continue}if(k){o.push("</div>\n"),k=!1;continue}o.push("<div>"),a.sceditor.ie||o.push("<br />"),(c.documentMode&&c.documentMode<8||a.sceditor.ie<8)&&o.push("Â "),o.push("</div>\n");continue}j=e,i=a.sceditor.escapeEntities(f.val)}j&&!k?(o.push("<div>"),k=!0):!j&&k&&(o.push("</div>\n"),k=!1),o.push(i)}return k&&o.push("</div>\n"),o.join("")},d.toBBCode=function(a,b){return o(d.parse(a,b))},o=function(b){var c,e,f,g,h,i,j,k,l,m,n=[];while(b.length>0){if(!(c=b.shift()))continue;f=d.bbcodes[c.name],g=!!f&&f.isInline===!1,h=f&&f.isSelfClosing,j=g&&d.opts.breakBeforeBlock&&f.breakBefore!==!1||f&&f.breakBefore,k=g&&!h&&d.opts.breakStartBlock&&f.breakStart!==!1||f&&f.breakStart,l=g&&d.opts.breakEndBlock&&f.breakEnd!==!1||f&&f.breakEnd,m=g&&d.opts.breakAfterBlock&&f.breakAfter!==!1||f&&f.breakAfter,i=(f?f.quoteType:null)||d.opts.quoteType||a.sceditor.BBCodeParser.QuoteType.auto;if(!f&&c.type===t.open)n.push(c.val),c.children&&n.push(o(c.children)),c.closing&&n.push(c.closing.val);else if(c.type===t.open){j&&n.push("\n"),n.push("["+c.name);if(c.attrs){c.attrs.defaultattr&&(n.push("="+q(c.attrs.defaultattr,i,"defaultattr")),delete c.attrs.defaultattr);for(e in c.attrs)c.attrs.hasOwnProperty(e)&&n.push(" "+e+"="+q(c.attrs[e],i,e))}n.push("]"),k&&n.push("\n"),c.children&&n.push(o(c.children)),!h&&!f.excludeClosing&&(l&&n.push("\n"),n.push("[/"+c.name+"]")),m&&n.push("\n"),c.closing&&h&&n.push(c.closing.val)}else n.push(c.val)}return n.join("")},q=function(b,c,d){var e=a.sceditor.BBCodeParser.QuoteType,f=/\s|=/.test(b);return a.isFunction(c)?c(b,d):c===e.never||c===e.auto&&!f?b:'"'+b.replace("\\","\\\\").replace('"','\\"')+'"'},s=function(a){return a.length?a[a.length-1]:null},r=function(a){return a.toLowerCase()},e()},a.sceditor.BBCodeParser.QuoteType={always:1,never:2,auto:3},Object.freeze&&Object.freeze(a.sceditor.BBCodeParser.QuoteType),a.sceditor.BBCodeParser.defaults={breakBeforeBlock:!1,breakStartBlock:!1,breakEndBlock:!1,breakAfterBlock:!0,removeEmptyTags:!0,fixInvalidNesting:!0,fixInvalidChildren:!0,quoteType:a.sceditor.BBCodeParser.QuoteType.auto},a.sceditorBBCodePlugin=a.sceditor.plugins.bbcode=function(){var b=this,d,e,f,g,h,i,j;g=a.sceditor.plugins.bbcode.formatString,b.bbcodes=a.sceditor.plugins.bbcode.bbcodes,b.stripQuotes=a.sceditor.plugins.bbcode.stripQuotes;var k={},l={},m={ul:["li","ol","ul"],ol:["li","ol","ul"],table:["tr"],tr:["td","th"],code:["br","p","div"]},n={};b.init=function(){b.opts=this.opts,d(),i(this)},i=function(b){var c={bold:{txtExec:["[b]","[/b]"]},italic:{txtExec:["[i]","[/i]"]},underline:{txtExec:["[u]","[/u]"]},strike:{txtExec:["[s]","[/s]"]},subscript:{txtExec:["[sub]","[/sub]"]},superscript:{txtExec:["[sup]","[/sup]"]},left:{txtExec:["[left]","[/left]"]},center:{txtExec:["[center]","[/center]"]},right:{txtExec:["[right]","[/right]"]},justify:{txtExec:["[justify]","[/justify]"]},font:{txtExec:function(b){var c=this;a.sceditor.command.get("font")._dropDown(c,b,function(a){c.insertText("[font="+a+"]","[/font]")})}},size:{txtExec:function(b){var c=this;a.sceditor.command.get("size")._dropDown(c,b,function(a){c.insertText("[size="+a+"]","[/size]")})}},color:{txtExec:function(b){var c=this;a.sceditor.command.get("color")._dropDown(c,b,function(a){c.insertText("[color="+a+"]","[/color]")})}},bulletlist:{txtExec:["[ul][li]","[/li][/ul]"]},orderedlist:{txtExec:["[ol][li]","[/li][/ol]"]},table:{txtExec:["[table][tr][td]","[/td][/tr][/table]"]},horizontalrule:{txtExec:["[hr]"]},code:{txtExec:["[code]","[/code]"]},image:{txtExec:function(a,b){var c=prompt(this._("Enter the image URL:"),b);c&&this.insertText("[img]"+c+"[/img]")}},email:{txtExec:function(a,b){var c=b&&b.indexOf("@")>-1?null:b,d=prompt(this._("Enter the e-mail address:"),c?"":b),e=prompt(this._("Enter the displayed text:"),c||d)||d;d&&this.insertText("[email="+d+"]"+e+"[/email]")}},link:{txtExec:function(a,b){var c=b&&b.indexOf("http://")>-1?null:b,d=prompt(this._("Enter URL:"),c?"http://":b),e=prompt(this._("Enter the displayed text:"),c||d)||d;d&&this.insertText("[url="+d+"]"+e+"[/url]")}},quote:{txtExec:["[quote]","[/quote]"]},youtube:{txtExec:function(b){var c=this;a.sceditor.command.get("youtube")._dropDown(c,b,function(a){c.insertText("[youtube]"+a+"[/youtube]")})}},rtl:{txtExec:["[rtl]","[/rtl]"]},ltr:{txtExec:["[ltr]","[/ltr]"]}};b.commands=a.extend(!0,{},c,b.commands)},d=function(){a.each(b.bbcodes,function(c){b.bbcodes[c].tags&&a.each(b.bbcodes[c].tags,function(a,d){var e=b.bbcodes[c].isInline===!1;k[a]=k[a]||{},k[a][e]=k[a][e]||{},k[a][e][c]=d}),b.bbcodes[c].styles&&a.each(b.bbcodes[c].styles,function(a,d){var e=b.bbcodes[c].isInline===!1;l[e]=l[e]||{},l[e][a]=l[e][a]||{},l[e][a][c]=d})})},h=function(b,c){var d,e,f,g,h,i=b.style;return i?(n[c]||(n[c]=a.camelCase(c)),h=n[c],"text-align"===c?(d=a(b),f=i.direction,g=i[h]||d.css(c),d.parent().css(c)!==g&&d.css("display")==="block"&&!d.is("hr")&&!d.is("th")&&(e=g),f&&e&&(/right/i.test(e)&&f==="rtl"||/left/i.test(e)&&f==="ltr")?null:e):i[h]):null},e=function(c,d,e){var f;return e=!!e,l[e]?(a.each(l[e],function(e,i){f=h(c[0],e);if(!f||h(c.parent()[0],e)===f)return;a.each(i,function(e,h){if(!h||a.inArray(f.toString(),h)>-1)a.isFunction(b.bbcodes[e].format)?d=b.bbcodes[e].format.call(b,c,d):d=g(b.bbcodes[e].format,d)})}),d):d},f=function(c,d,e){var f=c[0].nodeName.toLowerCase();e=!!e,k[f]&&k[f][e]&&a.each(k[f][e],function(e,f){if(f){var h=!1;a.each(f,function(b,d){if(!c.attr(b)||d&&a.inArray(c.attr(b),d)<0)return;return h=!0,!1});if(!h)return}a.isFunction(b.bbcodes[e].format)?d=b.bbcodes[e].format.call(b,c,d):d=g(b.bbcodes[e].format,d)});if(e&&(!a.sceditor.dom.isInline(c[0],!0)||f==="br")){var h=c[0].parentNode,i=c[0].previousSibling,j=a.sceditor.dom.isInline(h,!0)||h.nodeName.toLowerCase()==="body";if(j||f==="li"||h.lastChild!==c[0]||f==="br"&&a.sceditor.ie)d+="\n";"br"!==f&&!j&&i&&i.nodeType===3&&(d="\n"+d)}return d},b.signalToSource=function(c,d){var e=new a.sceditor.BBCodeParser(b.opts.parserOptions);return a.sceditor.dom.removeWhiteSpace(d[0]),a.trim(e.toBBCode(b.elementToBbcode(d),!0))},b.elementToBbcode=function(b){return function c(b,d){var g="";return a.sceditor.dom.traverse(b,function(b){var h=a(b),i="",j=b.nodeType,k=b.nodeName.toLowerCase(),l=m[k],n=!0;typeof d=="object"&&(n=a.inArray(k,d)>-1,n||(l=d));if(j!==3&&j!==1)return;if(j===1){if(h.hasClass("sceditor-ignore"))return;k!=="iframe"&&(i=c(b,l)),n?(k!=="code"&&(i=e(h,i),i=f(h,i),i=e(h,i,!0)),g+=f(h,i,!0)):g+=i}else b.wholeText&&(!b.previousSibling||b.previousSibling.nodeType!==3)?h.parents("code").length===0?g+=b.wholeText.replace(/ +/g," "):g+=b.wholeText:b.wholeText||(g+=b.nodeValue)},!1,!0),g}(b.get(0))},b.signalToWysiwyg=function(c,d){var e=new a.sceditor.BBCodeParser(b.opts.parserOptions),f=e.toHTML(c);return d?j(f):f},j=function(b){var d,e,f,g=a("<div />").hide().appendTo(c.body),h=g[0];return f=function(b){while(e=b.firstChild)h.insertBefore(e,b);a.sceditor.ie>=9&&h.insertBefore(c.createElement("br"),b),h.removeChild(b)},h.innerHTML=b.replace(/<\/div>\n/g,"</div>"),d=h.firstChild,d&&d.nodeName.toLowerCase()==="div"&&f(d),d=h.lastChild,d&&d.nodeName.toLowerCase()==="div"&&f(d),h=h.innerHTML,g.remove(),h}},a.sceditor.plugins.bbcode.stripQuotes=function(a){return a.replace(/^(["'])(.*?)\1$/,"$2")},a.sceditor.plugins.bbcode.formatString=function(){var a=arguments;return a[0].replace(/\{(\d+)\}/g,function(b,c){return typeof a[c-0+1]!="undefined"?a[c-0+1]:"{"+c+"}"})},a.sceditor.plugins.bbcode.normaliseColour=function(a){function c(a){return a=parseInt(a,10),isNaN(a)?"00":(a=Math.max(0,Math.min(a,255)).toString(16),a.length<2?"0"+a:a)}var b;return(b=a.match(/rgb\((\d{1,3}),\s*?(\d{1,3}),\s*?(\d{1,3})\)/i))?"#"+c(b[1])+c(b[2]-0)+c(b[3]-0):(b=a.match(/#([0-f])([0-f])([0-f])\s*?$/i))?"#"+b[1]+b[1]+b[2]+b[2]+b[3]+b[3]:a},a.sceditor.plugins.bbcode.bbcodes={b:{tags:{b:null,strong:null},styles:{"font-weight":["bold","bolder","401","700","800","900"]},format:"[b]{0}[/b]",html:"<strong>{0}</strong>"},i:{tags:{i:null,em:null},styles:{"font-style":["italic","oblique"]},format:"[i]{0}[/i]",html:"<em>{0}</em>"},u:{tags:{u:null},styles:{"text-decoration":["underline"]},format:"[u]{0}[/u]",html:"<u>{0}</u>"},s:{tags:{s:null,strike:null},styles:{"text-decoration":["line-through"]},format:"[s]{0}[/s]",html:"<s>{0}</s>"},sub:{tags:{sub:null},format:"[sub]{0}[/sub]",html:"<sub>{0}</sub>"},sup:{tags:{sup:null},format:"[sup]{0}[/sup]",html:"<sup>{0}</sup>"},font:{tags:{font:{face:null}},styles:{"font-family":null},quoteType:a.sceditor.BBCodeParser.QuoteType.never,format:function(a,b){var c;if(a[0].nodeName.toLowerCase()!=="font"||!(c=a.attr("face")))c=a.css("font-family");return"[font="+this.stripQuotes(c)+"]"+b+"[/font]"},html:function(a,b,c){return'<font face="'+b.defaultattr+'">'+c+"</font>"}},size:{tags:{font:{size:null}},styles:{"font-size":null},format:function(a,b){var c=a.attr("size"),d=1;return c||(c=a.css("fontSize")),c.indexOf("px")>-1?(c=c.replace("px","")-0,c>12&&(d=2),c>15&&(d=3),c>17&&(d=4),c>23&&(d=5),c>31&&(d=6),c>47&&(d=7)):d=c,"[size="+d+"]"+b+"[/size]"},html:function(a,b,c){return'<font size="'+b.defaultattr+'">'+c+"</font>"}},color:{tags:{font:{color:null}},styles:{color:null},quoteType:a.sceditor.BBCodeParser.QuoteType.never,format:function(b,c){var d,e=b[0];if(e.nodeName.toLowerCase()!=="font"||!(d=b.attr("color")))d=e.style.color||b.css("color");return"[color="+a.sceditor.plugins.bbcode.normaliseColour(d)+"]"+c+"[/color]"},html:function(a,b,c){return'<font color="'+b.defaultattr+'">'+c+"</font>"}},ul:{tags:{ul:null},breakStart:!0,isInline:!1,skipLastLineBreak:!0,format:"[ul]{0}[/ul]",html:"<ul>{0}</ul>"},list:{breakStart:!0,isInline:!1,skipLastLineBreak:!0,html:"<ul>{0}</ul>"},ol:{tags:{ol:null},breakStart:!0,isInline:!1,skipLastLineBreak:!0,format:"[ol]{0}[/ol]",html:"<ol>{0}</ol>"},li:{tags:{li:null},isInline:!1,closedBy:["/ul","/ol","/list","*","li"],format:"[li]{0}[/li]",html:"<li>{0}</li>"},"*":{isInline:!1,closedBy:["/ul","/ol","/list","*","li"],html:"<li>{0}</li>"},table:{tags:{table:null},isInline:!1,isHtmlInline:!0,skipLastLineBreak:!0,format:"[table]{0}[/table]",html:"<table>{0}</table>"},tr:{tags:{tr:null},isInline:!1,skipLastLineBreak:!0,format:"[tr]{0}[/tr]",html:"<tr>{0}</tr>"},th:{tags:{th:null},allowsEmpty:!0,isInline:!1,format:"[th]{0}[/th]",html:"<th>{0}</th>"},td:{tags:{td:null},allowsEmpty:!0,isInline:!1,format:"[td]{0}[/td]",html:"<td>{0}</td>"},emoticon:{allowsEmpty:!0,tags:{img:{src:null,"data-sceditor-emoticon":null}},format:function(a,b){return a.attr("data-sceditor-emoticon")+b},html:"{0}"},hr:{tags:{hr:null},allowsEmpty:!0,isSelfClosing:!0,isInline:!1,format:"[hr]{0}",html:"<hr />"},img:{allowsEmpty:!0,tags:{img:{src:null}},quoteType:a.sceditor.BBCodeParser.QuoteType.never,format:function(b,c){var d="",e=function(a){return b.style?b.style[a]:null};if(typeof b.attr("data-sceditor-emoticon")!="undefined")return c;if(b.attr("width")||b.attr("height")||e("width")||e("height"))d="="+a(b).width()+"x"+a(b).height();return"[img"+d+"]"+b.attr("src")+"[/img]"},html:function(a,b,c){var d,e="";return typeof b.width!="undefined"&&(e+=' width="'+b.width+'"'),typeof b.height!="undefined"&&(e+=' height="'+b.height+'"'),typeof b.defaultattr!="undefined"&&(d=b.defaultattr.split(/x/i),e=' width="'+d[0]+'"'+' height="'+(d.length===2?d[1]:d[0])+'"'),"<img"+e+' src="'+c+'" />'}},url:{allowsEmpty:!0,tags:{a:{href:null}},quoteType:a.sceditor.BBCodeParser.QuoteType.never,format:function(a,b){var c=a.attr("href");return c.substr(0,7)==="mailto:"?'[email="'+c.substr(7)+'"]'+b+"[/email]":"[url="+decodeURI(c)+"]"+b+"[/url]"},html:function(a,b,c){if(typeof b.defaultattr=="undefined"||b.defaultattr.length===0)b.defaultattr=c;return'<a href="'+encodeURI(b.defaultattr)+'">'+c+"</a>"}},email:{quoteType:a.sceditor.BBCodeParser.QuoteType.never,html:function(a,b,c){return typeof b.defaultattr=="undefined"&&(b.defaultattr=c),'<a href="mailto:'+b.defaultattr+'">'+c+"</a>"}},quote:{tags:{blockquote:null},isInline:!1,quoteType:a.sceditor.BBCodeParser.QuoteType.never,format:function(b,c){var d="",e=a(b),f=e.children("cite").first();if(f.length===1||e.data("author"))d=f.text()||e.data("author"),e.data("author",d),f.remove(),e.children("cite").replaceWith(function(){return a(this).text()}),c=this.elementToBbcode(a(b)),d="="+d;return"[quote"+d+"]"+c+"[/quote]"},html:function(a,b,c){return typeof b.defaultattr!="undefined"&&(c="<cite>"+b.defaultattr+"</cite>"+c),"<blockquote>"+c+"</blockquote>"}},code:{tags:{code:null},isInline:!1,allowedChildren:["#","#newline"],format:"[code]{0}[/code]",html:"<code>{0}</code>"},left:{styles:{"text-align":["left","-webkit-left","-moz-left","-khtml-left"]},isInline:!1,format:"[left]{0}[/left]",html:'<div align="left">{0}</div>'},center:{styles:{"text-align":["center","-webkit-center","-moz-center","-khtml-center"]},isInline:!1,format:"[center]{0}[/center]",html:'<div align="center">{0}</div>'},right:{styles:{"text-align":["right","-webkit-right","-moz-right","-khtml-right"]},isInline:!1,format:"[right]{0}[/right]",html:'<div align="right">{0}</div>'},justify:{styles:{"text-align":["justify","-webkit-justify","-moz-justify","-khtml-justify"]},isInline:!1,format:"[justify]{0}[/justify]",html:'<div align="justify">{0}</div>'},youtube:{allowsEmpty:!0,tags:{iframe:{"data-youtube-id":null}},format:function(a,b){return(a=a.attr("data-youtube-id"))?"[youtube]"+a+"[/youtube]":b},html:'<iframe width="560" height="315" src="http://www.youtube.com/embed/{0}?wmode=opaque" data-youtube-id="{0}" frameborder="0" allowfullscreen></iframe>'},rtl:{styles:{direction:["rtl"]},format:"[rtl]{0}[/rtl]",html:'<div style="direction: rtl">{0}</div>'},ltr:{styles:{direction:["ltr"]},format:"[ltr]{0}[/ltr]",html:'<div style="direction: ltr">{0}</div>'},ignore:{}},a.sceditor.plugins.bbcode.bbcode={get:function(b){return a.sceditor.plugins.bbcode.bbcodes[b]||null},set:function(b,c){return!b||!c?!1:(c=a.extend(a.sceditor.plugins.bbcode.bbcodes[b]||{},c),c.remove=function(){a.sceditor.plugins.bbcode.bbcode.remove(b)},a.sceditor.plugins.bbcode.bbcodes[b]=c,this)},rename:function(a,b){return this.hasOwnProperty(a)?(this[b]=this[a],this.remove(a),this):!1},remove:function(b){return a.sceditor.plugins.bbcode.bbcodes[b]&&delete a.sceditor.plugins.bbcode.bbcodes[b],this}},a.fn.sceditorBBCodePlugin=function(b){return b=b||{},a.isPlainObject(b)&&(b.plugins=(b.plugins?b.plugins:"")+"bbcode"),this.sceditor(b)}})(jQuery,window,document);