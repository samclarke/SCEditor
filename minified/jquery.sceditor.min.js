(function(d){d.sceditor=function(b,c){var a=this,e=d(b),f=null,i=null,g=null,h=null,k=null,j=null,n=!1,q=[],m=null,r=null,I=[],o,p,w,x,y,v,z,A,B,C,D,E,F,l,G,t,u,H,s;a.commands=d.sceditor.commands;A=function(){var c=d('<div contenteditable="true">')[0].contentEditable,c="undefined"!==typeof c&&"inherit"!==c;k=d("<textarea></textarea>").hide();g=d('<iframe frameborder="0"></iframe>');"https:"===window.location.protocol&&g.attr("src","javascript:false");f.append(g).append(k);h=g[0];u(e.width());t(e.height());
c||(l().designMode="On");l().open();l().write('<html><head><link rel="stylesheet" type="text/css" href="'+a.options.style+'" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /></head><body contenteditable="true"></body></html>');l().close();c||(l().designMode="On");d(l()).find("body").keypress(v);d(l()).keypress(v);d(l()).mousedown(z);d(l()).bind("beforedeactivate keypress",y);d(l()).focus(function(){m=null})};B=function(){var c=function(c){x(d(this),a.commands[d(this).data("sceditor-command")]);
c.preventDefault()};i=d('<div class="sceditor-toolbar" />');for(var b=a.options.toolbar.split("|"),e=0;e<b.length;e++){for(var n=d('<div class="sceditor-group" />'),j=b[e].split(","),g=0;g<j.length;g++)if(a.commands.hasOwnProperty(j[g])){var h=d('<a class="sceditor-button sceditor-button-'+j[g]+' " unselectable="on"><div unselectable="on" /></a>');a.commands[j[g]].hasOwnProperty("tooltip")&&h.attr("title",a._(a.commands[j[g]].tooltip));a.commands[j[g]].exec?h.data("sceditor-wysiwygmode",!0):h.addClass("disabled");
a.commands[j[g]].txtExec&&h.data("sceditor-txtmode",!0);h.data("sceditor-command",j[g]);h.click(c);n.append(h)}i.append(n)}null===a.options.toolbarContainer?f.append(i):d(a.options.toolbarContainer).append(i)};C=function(){d.each(a.commands,function(a,c){"undefined"!==typeof c.keyPress&&q.push(c.keyPress)})};u=function(a){f.width(a);g.width(a);g.width(a+(a-g.outerWidth(!0)));k.width(a);k.width(a+(a-k.outerWidth(!0)))};t=function(c){f.height(c);c-=null===a.options.toolbarContainer?i.outerHeight():
0;g.height(c);g.height(c+(c-g.outerHeight(!0)));k.height(c);k.height(c+(c-k.outerHeight(!0)))};D=function(){var c=d('<div class="sceditor-grip" />'),b=d('<div class="sceditor-resize-cover" />'),e=0,g=0,j=0,n=0,i=f.width(),h=f.height(),m=!1,q,p,k,o,l;q=null==a.options.resizeMinHeight?h/2:a.options.resizeMinHeight;p=null==a.options.resizeMaxHeight?2*h:a.options.resizeMaxHeight;k=null==a.options.resizeMinWidth?i/2:a.options.resizeMinWidth;o=null==a.options.resizeMaxWidth?2*i:a.options.resizeMaxWidth;
l=function(a){var c=n+(a.pageY-g),d=j+(a.pageX-e);d>=k&&(0>o||d<=o)&&u(d);c>=q&&(0>p||c<=p)&&t(c);a.preventDefault()};f.append(c);f.append(b.hide());c.mousedown(function(a){e=a.pageX;g=a.pageY;j=f.width();n=f.height();m=!0;b.show();d(document).bind("mousemove",l);a.preventDefault()});d(document).mouseup(function(a){m&&(m=!1,b.hide(),d(document).unbind("mousemove",l),a.preventDefault())})};F=function(){var c=d.extend({},a.options.emoticons.more,a.options.emoticons.dropdown,a.options.emoticons.hidden);
d.each(c,function(a,c){var d=document.createElement("img");d.src=c;I.push(d)})};a.createDropDown=function(c,b,e,f){a.closeDropDown();!1!==f&&(e=d(e),e.find(":not(input,textarea)").filter(function(){return 1===this.nodeType}).attr("unselectable","on"));j=d('<div class="sceditor-dropdown sceditor-'+b+'" />').css({top:c.offset().top,left:c.offset().left}).append(e);j.appendTo(d("body"));n=!0;j.click(function(a){a.stopPropagation()})};E=function(c){!n&&3!==c.which&&a.closeDropDown();n=!1};a.closeDropDown=
function(c){null!==j&&(j.remove(),j=null);!0===c&&a.focus()};l=function(){return h.contentDocument?h.contentDocument:h.contentWindow&&h.contentWindow.document?h.contentWindow.document:h.document?h.document:null};a.wysiwygEditorInsertHtml=function(c,b,e){a.focus();if(e||!(d(o()).is("code")||0!==d(o()).parents("code").length)){"undefined"!==typeof b&&null!==b&&(c=c+a.getWysiwygSelectedHtml()+b);if(l().getSelection){b=p();e=l().createElement("div");e.innerHTML=c;e=e.children[0];b.deleteContents();b.insertNode(e);
b=b.cloneRange();if(e.parentNode!==b.startContainer||!d.browser.opera)b.setStartAfter(e);else return;h.contentWindow.getSelection().removeAllRanges();h.contentWindow.getSelection().addRange(b)}else l().selection&&l().selection.createRange?l().selection.createRange().pasteHTML(c):a.execCommand("insertHtml",c);m=null}};a.wysiwygEditorInsertText=function(c){c=c.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ /g,"&nbsp;").replace(/\r\n|\r/g,"\n").replace(/\n/g,"<br />");a.wysiwygEditorInsertHtml("<span>"+
c+"</span>")};p=function(){var a;h.contentWindow&&h.contentWindow.getSelection?a=h.contentWindow.getSelection():l().selection&&(a=l().selection);a.getRangeAt&&0>=a.rangeCount&&a.addRange(l().createRange());return a.getRangeAt?a.getRangeAt(0):a.createRange?a.createRange():null};a.getWysiwygSelectedHtml=function(){var a=p();if(null===a)return"";if(document.selection&&document.selection.createRange){if(""===a.text)return"";if("undefined"!==typeof a.htmlText)return a.htmlText}if(window.XMLSerializer){var c=
"";d(a.cloneContents().childNodes).each(function(){c+=(new XMLSerializer).serializeToString(this)});return c}};o=function(){var a=p();if(null===a)return null;if(window.getSelection&&"undefined"!==typeof a.commonAncestorContainer)return a.commonAncestorContainer;if(document.selection&&document.selection.createRange)return a.parentElement()};a.getWysiwygEditorValue=function(c){var b=g.contents().find("body");d.sceditor.dom.fixNesting(b.get(0));var e=b.html();!1!==c&&a.options.getHtmlHandler&&(e=a.options.getHtmlHandler(e,
b));return e};a.getTextareaValue=function(c){var d=k.val();!1!==c&&a.options.getTextHandler&&(d=a.options.getTextHandler(d));return d};a.setWysiwygEditorValue=function(a){l().body.innerHTML=w(a)};a.setTextareaValue=function(a){k.val(a)};a.updateTextareaValue=function(){s()?e.val(a.getTextareaValue(!1)):e.val(a.getWysiwygEditorValue())};w=function(c){var b=d.extend({},a.options.emoticons.more,a.options.emoticons.dropdown,a.options.emoticons.hidden);d.each(b,function(d,b){var e=a.regexEscape(d)+"(?=([^\\<\\>]*?<(?!/code)|[^\\<\\>]*?$))",
f="";a.options.emoticonsCompat&&(e="((>|^|\\s){1})"+e+"(?=(\\s|$|<){1})",f="$1");c=c.replace(RegExp(e,"gm"),f+'<img src="'+b+'" data-sceditor-emoticon="'+d+'" />')});return c};a.regexEscape=function(a){return a.replace(/[\$\?\[\]\.\*\(\)\|]/g,"\\$&").replace("<","&lt;").replace(">","&gt;")};s=function(){return k.is(":visible")};a.toggleTextMode=function(){s()?a.setWysiwygEditorValue(a.getTextareaValue()):a.setTextareaValue(a.getWysiwygEditorValue());i.find(".sceditor-button").removeClass("disabled");
m=null;k.toggle();g.toggle();i.find(".sceditor-button").each(function(){var a=d(this);s()&&!a.data("sceditor-txtmode")?a.addClass("disabled"):!s()&&!a.data("sceditor-wysiwygmode")&&a.addClass("disabled")})};x=function(c,b){s()?b.hasOwnProperty("txtExec")&&b.txtExec.call(a,c):b.hasOwnProperty("exec")&&(d.isFunction(b.exec)?b.exec.call(a,c):a.execCommand(b.exec,b.hasOwnProperty("execParam")?b.execParam:null))};a.focus=function(){h.contentWindow.focus();null!==m&&(window.document.createRange?window.getSelection().addRange(m):
window.document.selection&&m.select(),m=null)};y=function(){d.browser.msie&&(m=p())};a.execCommand=function(c,b){var e=!1;a.focus();if(!(d(o()).is("code")||0!==d(o()).parents("code").length)){if(l())try{e=l().execCommand(c,!1,b)}catch(f){}!e&&"undefined"!==typeof a.commands[c]&&"undefined"!==typeof a.commands[c].errorMessage&&alert(a._(a.commands[c].errorMessage))}};v=function(c){a.closeDropDown();var b=o(),b=d(b);if(13===c.which&&(b.is("code, blockquote")||0!==b.parents("code, blockquote").length))return a.wysiwygEditorInsertHtml("<br />",
null,!0),!1;var e=l();d.sceditor.dom.rTraverse(e.body,function(a){if(3===a.nodeType&&""!==a.nodeValue||"br"===a.nodeName.toLowerCase())return 0<d(a).parents("code, blockquote").length&&d(e.body).append(e.createElement("br")),!1},!0);if(!(b.is("code")||0!==b.parents("code").length))for(b=q.length;b--;)q[b].call(a,c,h,k)};z=function(){a.closeDropDown();m=null};G=function(){null!==a.options.height&&-1<a.options.height.toString().indexOf("%")&&t(f.parent().height()*(parseFloat(a.options.height)/100));
null!==a.options.width&&-1<a.options.width.toString().indexOf("%")&&u(f.parent().width()*(parseFloat(a.options.width)/100))};a._=function(){var a=arguments;null!==r&&r[a[0]]&&(a[0]=r[a[0]]);return a[0].replace(/\{(\d+)\}/g,function(c,b){return"undefined"!==typeof a[b-0+1]?a[b-0+1]:"{"+b+"}"})};H=function(){if(d.sceditor.locale[a.options.locale])r=d.sceditor.locale[a.options.locale];else{var c=a.options.locale.split("-");d.sceditor.locale[c[0]]&&(r=d.sceditor.locale[c[0]])}null!==r&&r.dateFormat&&
(a.options.dateFormat=r.dateFormat)};(function(){e.data("sceditor",a);a.options=d.extend({},d.sceditor.defaultOptions,c);null!==a.options.locale&&"en"!==a.options.locale&&H();null!==a.options.height&&e.height(a.options.height);null!==a.options.width&&e.width(a.options.width);(null!==a.options.height&&-1<a.options.height.toString().indexOf("%")||null!==a.options.width&&-1<a.options.width.toString().indexOf("%"))&&d(window).resize(G);f=d('<div class="sceditor-container" />').width(e.outerWidth()).height(e.outerHeight());
e.after(f);B();A();C();a.options.resizeEnabled&&D();d(document).click(E);e.parents("form").attr("novalidate","novalidate").submit(function(c){a.updateTextareaValue();d(this).removeAttr("novalidate");this.checkValidity&&!this.checkValidity()&&c.preventDefault();d(this).attr("novalidate","novalidate")});var b=e.hide().val();a.options.getTextHandler&&(b=a.options.getTextHandler(b));a.setWysiwygEditorValue(b);F()})()};d.sceditor.locale={};d.sceditor.commands={bold:{exec:"bold",tooltip:"Bold"},italic:{exec:"italic",
tooltip:"Italic"},underline:{exec:"underline",tooltip:"Underline"},strike:{exec:"strikethrough",tooltip:"Strikethrough"},subscript:{exec:"subscript",tooltip:"Subscript"},superscript:{exec:"superscript",tooltip:"Superscript"},left:{exec:"justifyleft",tooltip:"Align left"},center:{exec:"justifycenter",tooltip:"Center"},right:{exec:"justifyright",tooltip:"Align right"},justify:{exec:"justifyfull",tooltip:"Justify"},font:{exec:function(b){for(var c=this,a=c.options.fonts.split(","),e=d("<div />"),f=function(a){c.execCommand("fontname",
d(this).data("sceditor-font"));c.closeDropDown(!0);a.preventDefault()},i=0;i<a.length;i++)e.append(d('<a class="sceditor-font-option" href="#"><font face="'+a[i]+'">'+a[i]+"</font></a>").data("sceditor-font",a[i]).click(f));c.createDropDown(b,"font-picker",e)},tooltip:"Font Name"},size:{exec:function(b){for(var c=this,a=d("<div />"),e=function(a){c.execCommand("fontsize",d(this).data("sceditor-fontsize"));c.closeDropDown(!0);a.preventDefault()},f=1;7>=f;f++)a.append(d('<a class="sceditor-fontsize-option" href="#"><font size="'+
f+'">'+f+"</font></a>").data("sceditor-fontsize",f).click(e));c.createDropDown(b,"fontsize-picker",a)},tooltip:"Font Size"},color:{exec:function(b){for(var c=this,a={r:255,g:255,b:255},e=d("<div />"),f=this.options.colors?this.options.colors.split("|"):Array(21),i=[],g=0,h=0;h<f.length;++h){var k="undefined"!==typeof f[h]?f[h].split(","):Array(21);i[g++]='<div class="sceditor-color-column">';for(var j=0;j<k.length;++j){var n="undefined"!==typeof k[j]?k[j]:"#"+a.r.toString(16)+a.g.toString(16)+a.b.toString(16);
i[g++]='<a href="#" class="sceditor-color-option" style="background-color: '+n+'" data-color="'+n+'"></a>';a=0===j%5?{r:a.r,g:a.g-51,b:255}:{r:a.r,g:a.g,b:a.b-51}}i[g++]="</div>";a=0===h%5?{r:a.r-51,g:255,b:255}:{r:a.r,g:255,b:255}}e.append(i.join("")).find("a").click(function(a){c.execCommand("forecolor",d(this).attr("data-color"));c.closeDropDown(!0);a.preventDefault()});c.createDropDown(b,"color-picker",e)},tooltip:"Font Color"},removeformat:{exec:"removeformat",tooltip:"Remove Formatting"},cut:{exec:"cut",
tooltip:"Cut",errorMessage:"Your browser does not allow the cut command. Please use the keyboard shortcut Ctrl/Cmd-X"},copy:{exec:"copy",tooltip:"Copy",errorMessage:"Your browser does not allow the copy command. Please use the keyboard shortcut Ctrl/Cmd-C"},paste:{exec:"paste",tooltip:"Paste",errorMessage:"Your browser does not allow the paste command. Please use the keyboard shortcut Ctrl/Cmd-V"},pastetext:{exec:function(b){var c=this,a=d(this._('<form><div><label for="txt">{0}</label> <textarea cols="20" rows="7" id="txt"></textarea></div></form>',
this._("Paste your text inside the following box:"))).submit(function(){return!1});a.append(d(this._('<div><input type="button" class="button" value="{0}" /></div>',this._("Insert"))).click(function(a){c.wysiwygEditorInsertText(d(this).parent("form").find("#txt").val());c.closeDropDown(!0);a.preventDefault()}));c.createDropDown(b,"pastetext",a)},tooltip:"Paste Text"},bulletlist:{exec:"insertunorderedlist",tooltip:"Bullet list"},orderedlist:{exec:"insertorderedlist",tooltip:"Numbered list"},undo:{exec:"undo",
tooltip:"Undo"},redo:{exec:"redo",tooltip:"Redo"},table:{exec:function(b){var c=this,a=d(this._('<form><div><label for="rows">{0}</label><input type="text" id="rows" value="2" /></div><div><label for="cols">{1}</label><input type="text" id="cols" value="2" /></div></form>',this._("Rows:"),this._("Cols:"))).submit(function(){return!1});a.append(d(this._('<div><input type="button" class="button" value="{0}" /></div>',this._("Insert"))).click(function(a){var b=d(this).parent("form").find("#rows").val()-
0,i=d(this).parent("form").find("#cols").val()-0,g="<table>";if(!(1>b||1>i)){for(var h=0;h<b;h++){for(var g=g+"<tr>",k=0;k<i;k++)g=d.browser.msie?g+"<td></td>":g+'<td><br class="sceditor-ignore" /></td>';g+="</tr>"}c.wysiwygEditorInsertHtml(g+"</table>");c.closeDropDown(!0);a.preventDefault()}}));c.createDropDown(b,"inserttable",a)},tooltip:"Insert a table"},horizontalrule:{exec:"inserthorizontalrule",tooltip:"Insert a horizontal rule"},code:{exec:function(){this.wysiwygEditorInsertHtml("<code>",
"<br /></code>")},tooltip:"Code"},image:{exec:function(b){var c=this,a=d(this._('<form><div><label for="link">{0}</label> <input type="text" id="image" value="http://" /></div><div><label for="width">{1}</label> <input type="text" id="width" size="2" /></div><div><label for="height">{2}</label> <input type="text" id="height" size="2" /></div></form>',this._("URL:"),this._("Width (optional):"),this._("Height (optional):"))).submit(function(){return!1});a.append(d(this._('<div><input type="button" class="button" value="Insert" /></div>',
this._("Insert"))).click(function(a){var b=d(this).parent("form"),i=b.find("#image").val(),g="",h;if(h=b.find("#width").val())g+=' width="'+h+'"';if(b=b.find("#height").val())g+=' height="'+b+'"';i&&"http://"!==i&&c.wysiwygEditorInsertHtml("<img"+g+' src="'+i+'" />');c.closeDropDown(!0);a.preventDefault()}));c.createDropDown(b,"insertimage",a)},tooltip:"Insert an image"},email:{exec:function(b){var c=this,a=d(this._('<form><div><label for="email">{0}</label> <input type="text" id="email" value="" /></div></form>',
this._("E-mail:"))).submit(function(){return!1});a.append(d('<div><input type="button" class="button" value="Insert" /></div>').click(function(a){var b=d(this).parent("form").find("#email").val();b&&(c.focus(),c.getWysiwygSelectedHtml()?c.execCommand("createlink","mailto:"+b):c.wysiwygEditorInsertHtml('<a href="mailto:'+b+'">'+b+"</a>"));c.closeDropDown(!0);a.preventDefault()}));c.createDropDown(b,"insertemail",a)},tooltip:"Insert an email"},link:{exec:function(b){var c=this,a=d(this._('<form><div><label for="link">{0}</label> <input type="text" id="link" value="http://" /></div><div><label for="des">{1}</label> <input type="text" id="des" value="" /></div></form>',
this._("URL:"),this._("Description (optional):"))).submit(function(){return!1});a.append(d(this._('<div><input type="button" class="button" value="{0}" /></div>',this._("Insert"))).click(function(a){var b=d(this).parent("form").find("#link").val(),i=d(this).parent("form").find("#des").val();""!==b&&"http://"!==b&&(c.focus(),!c.getWysiwygSelectedHtml()||i?(i||(i=b),c.wysiwygEditorInsertHtml('<a href="'+b+'">'+i+"</a>")):c.execCommand("createlink",b));c.closeDropDown(!0);a.preventDefault()}));c.createDropDown(b,
"insertlink",a)},tooltip:"Insert a link"},unlink:{exec:"unlink",tooltip:"Unlink"},quote:{exec:function(b,c){var a="<blockquote>",d="</blockquote>";c?(a=a+c+d,d=null):d="<br />"+d;this.wysiwygEditorInsertHtml(a,d)},tooltip:"Insert a Quote"},emoticon:{exec:function(b){var c=this,a=d("<div />"),e=d("<div />"),f=function(b,f){e.append(d("<img />").attr({src:f,alt:b}).click(function(a){var b,e;c.options.emoticonsCompat&&(b="<span> ",e=" </span>");c.wysiwygEditorInsertHtml(b+'<img src="'+d(this).attr("src")+
'" data-sceditor-emoticon="'+d(this).attr("alt")+'" />'+e);c.closeDropDown(!0);a.preventDefault()}));3<e.children().length&&(a.append(e),e=d("<div />"))};d.each(c.options.emoticons.dropdown,f);0<e.children().length&&a.append(e);if("undefined"!==typeof c.options.emoticons.more){var i=d(this._('<a class="sceditor-more">{0}</a>',this._("More"))).click(function(){var g=d.extend({},c.options.emoticons.dropdown,c.options.emoticons.more);a=d("<div />");e=d("<div />");d.each(g,f);0<e.children().length&&a.append(e);
c.createDropDown(b,"insertemoticon",a)});a.append(i)}c.createDropDown(b,"insertemoticon",a)},keyPress:function(b,c){var a=null,e=-1,f=this;c.contentWindow&&c.contentWindow.getSelection&&(a=c.contentWindow.getSelection().getRangeAt(0));if(null!=a&&a.startContainer){f.allEmoticonCache||(f.allEmoticonCache=d.extend({},f.options.emoticons.more,f.options.emoticons.dropdown,f.options.emoticons.hidden));f.longestEmoticonCode||(f.longestEmoticonCode=0,d.each(f.allEmoticonCache,function(a){a.length>f.longestEmoticonCode&&
(f.longestEmoticonCode=a.length)}),f.options.emoticonsCompat&&(f.longestEmoticonCode+=1));var i=String.fromCharCode(b.which),g=f.options.emoticonsCompat?/\s/.test(i):!1,h=a.startContainer.textContent.substr(0,a.startOffset),k=a.startContainer.textContent.substr(a.startOffset,f.longestEmoticonCode),j=h+i+k;d.each(f.allEmoticonCache,function(d,h){if(-1<(e=j.indexOf(d,a.startOffset-d.length))){if(f.options.emoticonsCompat){var m=RegExp("(\\s{1})"+f.regexEscape(d)+"(?=\\s{1})","gm");if(g&&-1<(i+k).indexOf(d)||
!m.test(j))return}a=a.cloneRange();a.setStart(a.startContainer,e);a.setEnd(a.startContainer,e+d.length-(g?0:1));a.deleteContents();m=c.contentDocument.createElement("div");m.innerHTML='<img src="'+h+'" data-sceditor-emoticon="'+d+'" />';m=m.children[0];a.insertNode(m);a=a.cloneRange();a.setStartAfter(m);c.contentWindow.getSelection().removeAllRanges();c.contentWindow.getSelection().addRange(a);g||(b.preventDefault(),b.stopPropagation());return!1}})}},tooltip:"Insert an emoticon"},youtube:{exec:function(b){var c=
this,a=d(this._('<form><div><label for="link">{0}</label> <input type="text" id="link" value="http://" /></div></form>',this._("Video URL:"))).submit(function(){return!1});a.append(d(this._('<div><input type="button" class="button" value="{0}" /></div>',this._("Insert"))).click(function(a){var b=d(this).parent("form").find("#link").val();""!==b&&"http://"!==b&&(b=b.replace(/^[^v]+v.(.{11}).*/,"$1"),c.wysiwygEditorInsertHtml('<iframe width="560" height="315" src="http://www.youtube.com/embed/'+b+'?wmode=opaque" data-youtube-id="'+
b+'" frameborder="0" allowfullscreen></iframe>'));c.closeDropDown(!0);a.preventDefault()}));c.createDropDown(b,"insertlink",a)},tooltip:"Insert a YouTube video"},date:{exec:function(){var b=new Date,c=b.getYear(),a=b.getMonth()+1,b=b.getDate();2E3>c&&(c=1900+c);10>a&&(a="0"+a);10>b&&(b="0"+b);this.wysiwygEditorInsertHtml("<span>"+this.options.dateFormat.replace(/year/i,c).replace(/month/i,a).replace(/day/i,b)+"</span>")},tooltip:"Insert current date"},time:{exec:function(){var b=new Date,c=b.getHours(),
a=b.getMinutes(),b=b.getSeconds();10>c&&(c="0"+c);10>a&&(a="0"+a);10>b&&(b="0"+b);this.wysiwygEditorInsertHtml("<span>"+c+":"+a+":"+b+"</span>")},tooltip:"Insert current time"},print:{exec:"print",tooltip:"Print"},source:{exec:function(){this.toggleTextMode()},txtExec:function(){this.toggleTextMode()},tooltip:"View source"},ignore:{}};d.sceditor.dom={traverse:function(b,c,a,d,f){if(b)for(b=f?b.lastChild:b.firstChild;null!=b;){if(!a&&!1===c(b)||!d&&!1===this.traverse(b,c,a,d,f)||a&&!1===c(b))return!1;
b=f?b.previousSibling:b.nextSibling}},rTraverse:function(b,c,a,d){this.traverse(b,c,a,d,!0)},isInline:function(b,c){var a=(window.getComputedStyle?window.getComputedStyle(b):b.currentStyle).display;return c?"block"!==a:"inline"===a},copyCSS:function(b,c){for(var a="font-size,color,font-family,font-wieght,font-style,text-decoration".split(","),e=a.length,f=d(b),i=d(c);e--;)i.css(a[e],f.css(a[e]))},fixNesting:function(b){var c=this;c.traverse(b,function(a){if(1===a.nodeType&&!c.isInline(a)&&c.isInline(a.parentNode)){var b;
for(b=a;c.isInline(b.parentNode);)b=b.parentNode;var d=b.parentNode,i=c.extractContents(b,a);c.copyCSS(a,a);d.insertBefore(i,b);d.insertBefore(a,b)}})},findCommonAncestor:function(b,c){return d(b).parents().has(d(c)).first()},extractContents:function(b,c){var a=this,d=a.findCommonAncestor(b,c),f=!1,i=!1;return function h(d){var e=b.ownerDocument.createDocumentFragment();a.traverse(d,function(a){if(i||a===c&&f)return i=!0,!1;a===b&&(f=!0);var d;f?(jQuery.contains(a,c)&&1===a.nodeType&&(d=h(a),a=a.cloneNode(!1),
a.appendChild(d)),e.appendChild(a)):jQuery.contains(a,b)&&1===a.nodeType&&(d=h(a),a=a.cloneNode(!1),a.appendChild(d),e.appendChild(a))});return e}(null===d?null:d.get(0))}};d.sceditor.commandExists=function(b){return"undefined"!==typeof d.sceditor.commands[b]};d.sceditor.setCommand=function(b,c,a,e){if(!b||!c)return!1;d.sceditor.commandExists(b)||(d.sceditor.commands[b]={});d.sceditor.commands[b].exec=c;a&&(d.sceditor.commands[b].tooltip=a);e&&(d.sceditor.commands[b].keyPress=e);return!0};d.sceditor.defaultOptions=
{toolbar:"bold,italic,underline,strike,subscript,superscript|left,center,right,justify|font,size,color,removeformat|cut,copy,paste,pastetext|bulletlist,orderedlist|undo,redo|table|code,quote|horizontalrule,image,email,link,unlink|emoticon,youtube,date,time|print,source",style:"jquery.sceditor.default.css",fonts:"Arial,Arial Black,Comic Sans MS,Courier New,Georgia,Impact,Sans-serif,Serif,Times New Roman,Trebuchet MS,Verdana",colors:null,locale:"en",emoticonsCompat:!1,emoticons:{dropdown:{":)":"emoticons/smile.png",
":angel:":"emoticons/angel.png",":angry:":"emoticons/angry.png","8-)":"emoticons/cool.png",":'(":"emoticons/cwy.png",":ermm:":"emoticons/ermm.png",":D":"emoticons/grin.png","<3":"emoticons/heart.png",":(":"emoticons/sad.png",":O":"emoticons/shocked.png",":P":"emoticons/tongue.png",";)":"emoticons/wink.png"},more:{":alien:":"emoticons/alien.png",":blink:":"emoticons/blink.png",":blush:":"emoticons/blush.png",":cheerful:":"emoticons/cheerful.png",":devil:":"emoticons/devil.png",":dizzy:":"emoticons/dizzy.png",
":getlost:":"emoticons/getlost.png",":happy:":"emoticons/happy.png",":kissing:":"emoticons/kissing.png",":ninja:":"emoticons/ninja.png",":pinch:":"emoticons/pinch.png",":pouty:":"emoticons/pouty.png",":sick:":"emoticons/sick.png",":sideways:":"emoticons/sideways.png",":silly:":"emoticons/silly.png",":sleeping:":"emoticons/sleeping.png",":unsure:":"emoticons/unsure.png",":woot:":"emoticons/w00t.png",":wassat:":"emoticons/wassat.png"},hidden:{":whistling:":"emoticons/whistling.png",":love:":"emoticons/wub.png"}},
width:null,height:null,resizeEnabled:!0,resizeMinWidth:null,resizeMinHeight:null,resizeMaxHeight:null,resizeMaxWidth:null,getHtmlHandler:null,getTextHandler:null,dateFormat:"year-month-day",toolbarContainer:null};d.fn.sceditor=function(b){return this.each(function(){new d.sceditor(this,b)})}})(jQuery);(function(d){d.sceditorBBCodePlugin=function(b,c){var a=this,e,f,i;a.bbcodes=d.sceditorBBCodePlugin.bbcodes;var g={},h={},k={ul:["li"],ol:["li"],table:["tr","th"],tr:["td"],th:["td"],code:[],youtube:[]};e=function(b,c,e){var f,g=b.get(0).nodeName.toLowerCase(),e=!!e;if(!h[e])return c;d.each(h[e],function(e,h){if(!("a"===g&&("color"===e||"text-decoration"===e))&&!("code"===g&&"font-family"===e))f=b.css(e),b.parent().css(e)!==f&&d.each(h,function(e,g){if(null===g||-1<d.inArray(f.toString(),g))c=d.isFunction(a.bbcodes[e].format)?
a.bbcodes[e].format.call(a,b,c):i(a.bbcodes[e].format,c)})});return c};f=function(b,c,e){var f=b.get(0).nodeName.toLowerCase(),e=!!e;g[f]&&g[f][e]&&d.each(g[f][e],function(e,f){if(null!==f){var g=!1;d.each(f,function(a,c){if(!("undefined"===typeof b.attr(a)||null!==c&&0>d.inArray(b.attr(a),c)))return g=!0,!1});if(!g)return}c=d.isFunction(a.bbcodes[e].format)?a.bbcodes[e].format.call(a,b,c):i(a.bbcodes[e].format,c)});e&&/^(br|div|p)$/.test(f)&&(c+="\n");return c};i=function(){var a=arguments;return a[0].replace(/\{(\d+)\}/g,
function(c,b){return"undefined"!==typeof a[b-0+1]?a[b-0+1]:"{"+b+"}"})};a.stripQuotes=function(a){return a.replace(/^["']+/,"").replace(/["']+$/,"")};a.getHtmlHandler=function(c,b){return a.elementToBbcode(b)};a.elementToBbcode=function(a){return function q(a,c){var b="";d.sceditor.dom.traverse(a,function(a){var g=d(a),i="",h=a.nodeName.toLowerCase(),j=k[h],m=!0;"object"===typeof c&&((m=-1<d.inArray(h,c))||(j=c));3!==a.nodeType?g.hasClass("sceditor-ignore")||("iframe"!==h&&(i=q(a,j)),m?(g.is("code")||
(i=e(g,i),i=f(g,i),i=e(g,i,!0)),b+=f(g,i,!0)):b+=i):b+=a.nodeValue},!1,!0);return b}(a.get(0))};a.getTextHandler=function(b){for(var c=/\[([^\[\s=]*?)(?:([^\[]*?))?\]((?:[\s\S(?!=\[\\\1)](?!\[\1))*?)\[\/(\1)\]/g,e=/(\S+)=((?:(?:(["'])(?:\\\3|[^\3])*?\3))|(?:[^'"\s]+))/g,f,g=function(b,c,f,g){var h={},j;if(f)if(f=d.trim(f),"="===f.charAt(0)&&1>=f.split("=").length-1||"url"===c)h.defaultAttr=a.stripQuotes(f.substr(1));else for("="===f.charAt(0)&&(f="defaultAttr"+f);j=e.exec(f);)h[j[1].toLowerCase()]=
a.stripQuotes(j[2]);return!a.bbcodes[c]?b:d.isFunction(a.bbcodes[c].html)?a.bbcodes[c].html.call(a,c,h,g):i(a.bbcodes[c].html,g)},b=b.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"").replace(/(\[\/?(?:left|center|right|justify)\])\n/g,"$1").replace(/\n/g,"<br />");b!==f;)f=b,b=b.replace(c,g);b=b.replace(/\[hr\]/gi,"<hr>");return b.replace(/ {2}(?=([^<\>]*?<|[^<\>]*?$))/g," &nbsp;")};a.options=d.extend({},d.sceditor.defaultOptions,d.sceditorBBCodePlugin.defaultOptions,
c);(function(){d.each(a.bbcodes,function(b){"undefined"!==typeof a.bbcodes[b].tags&&d.each(a.bbcodes[b].tags,function(c,d){var e=!!a.bbcodes[b].isBlock;g[c]=g[c]||{};g[c][e]=g[c][e]||{};g[c][e][b]=d});"undefined"!==typeof a.bbcodes[b].styles&&d.each(a.bbcodes[b].styles,function(c,d){var e=!!a.bbcodes[b].isBlock;h[e]=h[e]||{};h[e][c]=h[e][c]||{};h[e][c][b]=d})})})();new d.sceditor(b,d.extend({},a.options,{getHtmlHandler:a.getHtmlHandler,getTextHandler:a.getTextHandler}))};d.sceditorBBCodePlugin.bbcodes=
{b:{styles:{"font-weight":"bold,bolder,401,700,800,900".split(",")},format:"[b]{0}[/b]",html:"<strong>{0}</strong>"},i:{styles:{"font-style":["italic","oblique"]},format:"[i]{0}[/i]",html:"<em>{0}</em>"},u:{styles:{"text-decoration":["underline"]},format:"[u]{0}[/u]",html:"<u>{0}</u>"},s:{styles:{"text-decoration":["line-through"]},format:"[s]{0}[/s]",html:"<s>{0}</s>"},sub:{tags:{sub:null},format:"[sub]{0}[/sub]",html:"<sub>{0}</sub>"},sup:{tags:{sup:null},format:"[sup]{0}[/sup]",html:"<sup>{0}</sup>"},
font:{styles:{"font-family":null},format:function(b,c){return b.css("font-family")===this.options.defaultFont?c:"[font="+this.stripQuotes(b.css("font-family"))+"]"+c+"[/font]"},html:function(b,c,a){return'<font face="'+c.defaultAttr+'">'+a+"</font>"}},size:{styles:{"font-size":null},format:function(b,c){var a=b.css("fontSize"),d=1;if(a===this.options.defaultSize)return c;-1<a.indexOf("px")?(a=a.replace("px","")-0,12<a&&(d=2),15<a&&(d=3),17<a&&(d=4),23<a&&(d=5),31<a&&(d=6),47<a&&(d=7)):d=a;return"[size="+
d+"]"+c+"[/size]"},html:function(b,c,a){return'<font size="'+c.defaultAttr+'">'+a+"</font>"}},color:{styles:{color:null},format:function(b,c){var a=function(a){function b(a){a=parseInt(a,10);if(isNaN(a))return"00";a=Math.max(0,Math.min(a,255)).toString(16);return 2>a.length?"0"+a:a}var c;return(c=a.match(/rgb\((\d+),\s*?(\d+),\s*?(\d+)\)/i))?"#"+b(c[1])+b(c[2]-0)+b(c[3]-0):a}(b.css("color"));return a===this.options.defaultColor?c:"[color="+a+"]"+c+"[/color]"},html:function(b,c,a){return'<font color="'+
c.defaultAttr+'">'+a+"</font>"}},ul:{tags:{ul:null},isBlock:!0,format:"[ul]{0}[/ul]",html:"<ul>{0}</ul>"},list:{html:"<ul>{0}</ul>"},ol:{tags:{ol:null},isBlock:!0,format:"[ol]{0}[/ol]",html:"<ol>{0}</ol>"},li:{tags:{li:null},format:"[li]{0}[/li]",html:"<li>{0}</li>"},"*":{html:"<li>{0}</li>"},table:{tags:{table:null},format:"[table]{0}[/table]",html:"<table>{0}</table>"},tr:{tags:{tr:null},format:"[tr]{0}[/tr]",html:"<tr>{0}</tr>"},th:{tags:{th:null},format:"[th]{0}[/th]",html:"<th>{0}</th>"},td:{tags:{td:null},
format:"[td]{0}[/td]",html:'<td>{0}<br class="sceditor-ignore" /></td>'},emoticon:{tags:{img:{src:null,"data-sceditor-emoticon":null}},format:function(b,c){return b.attr("data-sceditor-emoticon")+c},html:"{0}"},horizontalrule:{tags:{hr:null},format:"[hr]{0}",html:"<hr />"},img:{tags:{img:{src:null}},format:function(b,c){return"undefined"!==typeof b.attr("data-sceditor-emoticon")?c:"[img"+("="+d(b).width()+"x"+d(b).height())+"]"+b.attr("src")+"[/img]"},html:function(b,c,a){b="";"undefined"!==typeof c.width&&
(b+=' width="'+c.width+'"');"undefined"!==typeof c.height&&(b+=' height="'+c.height+'"');"undefined"!==typeof c.defaultAttr&&(c=c.defaultAttr.split(/x/i),b=' width="'+c[0]+'" height="'+(2===c.length?c[1]:c[0])+'"');return"<img "+b+' src="'+a+'" />'}},url:{tags:{a:{href:null}},format:function(b,c){return"mailto:"===b.attr("href").substr(0,7)?"[email="+b.attr("href").substr(7)+"]"+c+"[/email]":"[url="+decodeURI(b.attr("href"))+"]"+c+"[/url]"},html:function(b,c,a){if("undefined"===typeof c.defaultAttr||
0===c.defaultAttr.length)c.defaultAttr=a;return'<a href="'+encodeURI(c.defaultAttr)+'">'+a+"</a>"}},email:{html:function(b,c,a){"undefined"===typeof c.defaultAttr&&(c.defaultAttr=a);return'<a href="mailto:'+c.defaultAttr+'">'+a+"</a>"}},quote:{tags:{blockquote:null},isBlock:!0,format:function(b,c){var a="";1===d(b).children("cite:first").length&&(a="="+d(b).children("cite:first").text(),d(b).children("cite:first").remove(),c=this.elementToBbcode(d(b)));return"[quote"+a+"]"+c+"[/quote]"},html:function(b,
c,a){"undefined"!==typeof c.defaultAttr&&(a="<cite>"+c.defaultAttr+"</cite>"+a);return"<blockquote>"+a+"</blockquote>"}},code:{tags:{code:null},isBlock:!0,format:"[code]{0}[/code]",html:"<code>{0}</code>"},left:{styles:{"text-align":["left","-webkit-left","-moz-left","-khtml-left"]},isBlock:!0,format:"[left]{0}[/left]",html:'<div align="left">{0}</div>'},center:{styles:{"text-align":["center","-webkit-center","-moz-center","-khtml-center"]},isBlock:!0,format:"[center]{0}[/center]",html:'<div align="center">{0}</div>'},
right:{styles:{"text-align":["right","-webkit-right","-moz-right","-khtml-right"]},isBlock:!0,format:"[right]{0}[/right]",html:'<div align="right">{0}</div>'},justify:{styles:{"text-align":["justify","-webkit-justify","-moz-justify","-khtml-justify"]},isBlock:!0,format:"[justify]{0}[/justify]",html:'<div align="justify">{0}</div>'},youtube:{tags:{iframe:{"data-youtube-id":null}},format:function(b,c){return!b.attr("data-youtube-id")?c:"[youtube]"+b.attr("data-youtube-id")+"[/youtube]"},html:'<iframe width="560" height="315" src="http://www.youtube.com/embed/{0}?wmode=opaque" data-youtube-id="{0}" frameborder="0" allowfullscreen></iframe>'},
ignore:{}};d.sceditorBBCodePlugin.commandExists=function(b){return"undefined"!==typeof d.sceditorBBCodePlugin.bbcodes[b]};d.sceditorBBCodePlugin.setCommand=function(b,c,a,e,f){if(!b||!e||!f)return!1;d.sceditorBBCodePlugin.commandExists(b)||(d.sceditorBBCodePlugin.bbcodes[b]={});d.sceditorBBCodePlugin.bbcodes[b].format=e;d.sceditorBBCodePlugin.bbcodes[b].html=f;c&&(d.sceditorBBCodePlugin.bbcodes[b].tags=c);a&&(d.sceditorBBCodePlugin.bbcodes[b].styles=a);return!0};d.sceditorBBCodePlugin.defaultOptions=
{defaultSize:13,defaultColor:"#111111",defaultFont:"Verdana, Arial, Helvetica, sans-serif"};d.fn.sceditorBBCodePlugin=function(b){return this.each(function(){new d.sceditorBBCodePlugin(this,b)})}})(jQuery);
