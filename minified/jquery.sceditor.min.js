(function(a){a.sceditor=function(g,k){var m=this;var D=a(g);var u=g;var i=null;var H=null;var t=null;var s=null;var l=null;var e=null;var f=false;var p=[];var b=null;var h=[];var B,r,y,o,C,A,c,v,q,G,F,w,j,E,z,x,n,d;m.commands=a.sceditor.commands;B=function(){D.data("sceditor",m);m.options=a.extend({},a.sceditor.defaultOptions,k);if(m.options.height!==null){D.height(m.options.height)}if(m.options.width!==null){D.width(m.options.width)}if((m.options.height!==null&&m.options.height.toString().indexOf("%")>-1)||(m.options.width!==null&&m.options.width.toString().indexOf("%")>-1)){a(window).resize(x)}i=a('<div class="sceditor-container" />').width(D.outerWidth()).height(D.outerHeight());D.after(i);G();q();F();if(m.options.resizeEnabled){w()}D.parents("form").submit(m.updateTextareaValue);a(document).click(j);var I=D.hide().val();if(m.options.getTextHandler){I=m.options.getTextHandler(I)}m.setWysiwygEditorValue(I);E()};q=function(){l=a("<textarea></textarea>").hide();t=a('<iframe frameborder="0"></iframe>');if(window.location.protocol==="https:"){t.attr("src","javascript:false")}i.append(t).append(l);s=t[0];d(D.width());n(D.height());z().designMode="On";z().open();z().write('<html><head><link rel="stylesheet" type="text/css" href="'+m.options.style+'" /></head><body></body></html>');z().close();z().designMode="On";a(z()).find("body").keypress(c);a(z()).keypress(c);a(z()).mousedown(v);a(z()).bind("beforedeactivate keypress",A)};G=function(){var K=function(P){C(a(this),m.commands[a(this).data("sceditor-command")]);P.preventDefault()};H=a('<div class="sceditor-toolbar" />');var J=m.options.toolbar.split("|");for(var M=0;M<J.length;M++){var O=a('<div class="sceditor-group" />');var N=J[M].split(",");for(var I=0;I<N.length;I++){if(!m.commands.hasOwnProperty(N[I])){continue}var L=a('<a class="sceditor-button sceditor-button-'+N[I]+' " unselectable="on"><div unselectable="on" /></a>');if(m.commands[N[I]].hasOwnProperty("tooltip")){L.attr("title",m.commands[N[I]].tooltip)}L.data("sceditor-command",N[I]);L.click(K);O.append(L)}H.append(O)}if(m.options.toolbarContainer===null){i.append(H)}else{a(m.options.toolbarContainer).append(H)}};F=function(){a.each(m.commands,function(J,I){if(typeof I.keyPress!=="undefined"){p.push(I.keyPress)}})};d=function(I){i.width(I);t.width(I);t.width(I+(I-t.outerWidth(true)));l.width(I);l.width(I+(I-l.outerWidth(true)))};n=function(I){i.height(I);I=I-(m.options.toolbarContainer===null?H.outerHeight():0);t.height(I);t.height(I+(I-t.outerHeight(true)));l.height(I);l.height(I+(I-l.outerHeight(true)))};w=function(){var K=a('<div class="sceditor-grip" />'),V=a('<div class="sceditor-resize-cover" />'),N=0,L=0,M=0,T=0,S=i.width(),U=i.height(),Q=false,R,P,I,O,J;R=(m.options.resizeMinHeight==null?U/2:m.options.resizeMinHeight);P=(m.options.resizeMaxHeight==null?U*2:m.options.resizeMaxHeight);I=(m.options.resizeMinWidth==null?S/2:m.options.resizeMinWidth);O=(m.options.resizeMaxWidth==null?S*2:m.options.resizeMaxWidth);J=function(Y){var W=T+(Y.pageY-L);var X=M+(Y.pageX-N);if(X>=I&&(I<0||X<=O)){d(X)}if(W>=R&&(P<0||W<=P)){n(W)}Y.preventDefault()};i.append(K);i.append(V.hide());K.mousedown(function(W){N=W.pageX;L=W.pageY;M=i.width();T=i.height();Q=true;V.show();a(document).bind("mousemove",J);W.preventDefault()});a(document).mouseup(function(W){if(!Q){return}Q=false;V.hide();a(document).unbind("mousemove",J);W.preventDefault()})};E=function(){var I=a.extend({},m.options.emoticons.more,m.options.emoticons.dropdown,m.options.emoticons.hidden);a.each(I,function(L,J){var K=document.createElement("img");K.src=J;h.push(K)})};m.createDropDown=function(I,L,K,J){m.closeDropDown();if(J!==false){K=a(K);K.find(":not(input,textarea)").filter(function(){return this.nodeType===1}).attr("unselectable","on")}e=a('<div class="sceditor-dropdown sceditor-'+L+'" />').css({top:I.offset().top,left:I.offset().left}).append(K);e.appendTo(a("body"));f=true;e.click(function(M){M.stopPropagation()})};j=function(){if(!f){m.closeDropDown()}f=false};m.closeDropDown=function(I){if(e!==null){e.remove();e=null}if(I===true){m.focus()}};z=function(){if(s.contentDocument){return s.contentDocument}if(s.contentWindow&&s.contentWindow.document){return s.contentWindow.document}if(s.document){return s.document}return null};m.wysiwygEditorInsertHtml=function(J,L){m.focus();if(a(r()).is("code")||a(r()).parents("code").length!==0){return}if(typeof L!=="undefined"){J=J+m.getWysiwygSelectedHtml()+L}if(z().getSelection){var I=y();var K=z().createElement("div");K.innerHTML=J;K=K.children[0];I.deleteContents();I.insertNode(K);I=I.cloneRange();if(K.parentNode!==I.startContainer||!a.browser.opera){I.setStartAfter(K)}else{return}s.contentWindow.getSelection().removeAllRanges();s.contentWindow.getSelection().addRange(I)}else{if(z().selection&&z().selection.createRange){z().selection.createRange().pasteHTML(J)}else{m.execCommand("insertHtml",J)}}b=null};m.wysiwygEditorInsertText=function(I){I=I.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ /g,"&nbsp;").replace(/\r\n|\r/g,"\n").replace(/\n/g,"<br />");m.wysiwygEditorInsertHtml("<span>"+I+"</span>")};y=function(){var I;if(s.contentWindow&&s.contentWindow.getSelection){I=s.contentWindow.getSelection()}else{if(z().selection){I=z().selection}}if(I.getRangeAt){return I.getRangeAt(0)}else{if(I.createRange){return I.createRange()}}return null};m.getWysiwygSelectedHtml=function(){var J=y();if(J===null){return""}if(document.selection&&document.selection.createRange){if(J.text===""){return""}if(typeof J.htmlText!=="undefined"){return J.htmlText}}if(window.XMLSerializer){var I="";a(J.cloneContents().childNodes).each(function(){I+=new XMLSerializer().serializeToString(this)});return I}};r=function(){var I=y();if(I===null){return null}if(window.getSelection&&typeof I.commonAncestorContainer!=="undefined"){return I.commonAncestorContainer}if(document.selection&&document.selection.createRange){return I.parentElement()}};m.getWysiwygEditorValue=function(J){var I=t.contents().find("body").html();if(J!==false&&m.options.getHtmlHandler){I=m.options.getHtmlHandler(I,t.contents().find("body"))}return I};m.getTextareaValue=function(I){var J=l.val();if(I!==false&&m.options.getTextHandler){J=m.options.getTextHandler(J)}return J};m.setWysiwygEditorValue=function(I){z().body.innerHTML=o(I)};m.setTextareaValue=function(I){l.val(I)};m.updateTextareaValue=function(){if(l.is(":visible")){D.val(m.getTextareaValue(false))}else{D.val(m.getWysiwygEditorValue())}};o=function(I){var J=a.extend({},m.options.emoticons.more,m.options.emoticons.dropdown,m.options.emoticons.hidden);a.each(J,function(L,K){var M=L.replace(/[\$\?\[\]\.\*\(\)\|]/g,"\\$&").replace("<","&lt;").replace(">","&gt;")+"(?=([^\\<\\>]*?<(?!/code)|[^\\<\\>]*?$))";I=I.replace(new RegExp(M,"g"),'<img src="'+K+'" data-sceditor-emoticon="'+L+'" />')});return I};m.toggleTextMode=function(){if(l.is(":visible")){m.setWysiwygEditorValue(m.getTextareaValue())}else{m.setTextareaValue(m.getWysiwygEditorValue())}b=null;l.toggle();t.toggle()};C=function(I,J){if(!J.hasOwnProperty("exec")){return}if(a.isFunction(J.exec)){J.exec.call(m,I)}else{m.execCommand(J.exec,J.hasOwnProperty("execParam")?J.execParam:null)}};m.focus=function(){A();s.contentWindow.focus();if(b!==null){if(window.document.createRange){window.getSelection().addRange(b)}else{if(window.document.selection){b.select()}}}};A=function(){if(!a.browser.msie){return}b=y()};m.execCommand=function(L,K){var I=false;m.focus();if(a(r()).is("code")||a(r()).parents("code").length!==0){return}if(z()){try{I=z().execCommand(L,false,K)}catch(J){}}if(!I&&typeof m.commands[L]!=="undefined"&&typeof m.commands[L].errorMessage!=="undefined"){alert(m.commands[L].errorMessage)}};c=function(J){m.closeDropDown();if(a(r()).is("code")||a(r()).parents("code").length!==0){return}var I=p.length;while(I--){p[I].call(m,J,s,l)}};v=function(I){m.closeDropDown()};x=function(){if(m.options.height!==null&&m.options.height.toString().indexOf("%")>-1){n(i.parent().height()*(parseFloat(m.options.height)/100))}if(m.options.width!==null&&m.options.width.toString().indexOf("%")>-1){d(i.parent().width()*(parseFloat(m.options.width)/100))}};B()};a.sceditor.commands={bold:{exec:"bold",tooltip:"Bold"},italic:{exec:"italic",tooltip:"Italic"},underline:{exec:"underline",tooltip:"Underline"},strike:{exec:"strikethrough",tooltip:"Strikethrough"},subscript:{exec:"subscript",tooltip:"Subscript"},superscript:{exec:"superscript",tooltip:"Superscript"},left:{exec:"justifyleft",tooltip:"Align left"},center:{exec:"justifycenter",tooltip:"Center"},right:{exec:"justifyright",tooltip:"Align right"},justify:{exec:"justifyfull",tooltip:"Justify"},font:{exec:function(c){var e=this;var g=e.options.fonts.split(",");var f=a("<div />");var b=function(h){e.execCommand("fontname",a(this).data("sceditor-font"));e.closeDropDown(true);h.preventDefault()};for(var d=0;d<g.length;d++){f.append(a('<a class="sceditor-font-option" href="#"><font face="'+g[d]+'">'+g[d]+"</font></a>").data("sceditor-font",g[d]).click(b))}e.createDropDown(c,"font-picker",f)},tooltip:"Font Name"},size:{exec:function(c){var e=this;var f=a("<div />");var b=function(g){e.execCommand("fontsize",a(this).data("sceditor-fontsize"));e.closeDropDown(true);g.preventDefault()};for(var d=1;d<=7;d++){f.append(a('<a class="sceditor-fontsize-option" href="#"><font size="'+d+'">'+d+"</font></a>").data("sceditor-fontsize",d).click(b))}e.createDropDown(c,"fontsize-picker",f)},tooltip:"Font Size"},color:{exec:function(d){var j=this;var c={r:255,g:255,b:255};var k=a("<div />");var g=this.options.colors?this.options.colors.split("|"):new Array(21);var h=[];var m=0;for(var f=0;f<g.length;++f){var b=(typeof g[f]!=="undefined")?g[f].split(","):new Array(21);h[m++]='<div class="sceditor-color-column">';for(var l=0;l<b.length;++l){var e=(typeof b[l]!=="undefined")?b[l]:"#"+c.r.toString(16)+c.g.toString(16)+c.b.toString(16);h[m++]='<a href="#" class="sceditor-color-option" style="background-color: '+e+'" data-color="'+e+'"></a>';if(l%5===0){c={r:c.r,g:c.g-51,b:255}}else{c={r:c.r,g:c.g,b:c.b-51}}}h[m++]="</div>";if(f%5===0){c={r:c.r-51,g:255,b:255}}else{c={r:c.r,g:255,b:255}}}k.append(h.join("")).find("a").click(function(i){j.execCommand("forecolor",a(this).attr("data-color"));j.closeDropDown(true);i.preventDefault()});j.createDropDown(d,"color-picker",k)},tooltip:"Font Color"},removeformat:{exec:"removeformat",tooltip:"Remove Formatting"},cut:{exec:"cut",tooltip:"Cut",errorMessage:"Your browser dose not allow the cut command. Please use the keyboard shortcut Ctrl/Cmd-X"},copy:{exec:"copy",tooltip:"Copy",errorMessage:"Your browser dose not allow the copy command. Please use the keyboard shortcut Ctrl/Cmd-C"},paste:{exec:"paste",tooltip:"Paste",errorMessage:"Your browser dose not allow the paste command. Please use the keyboard shortcut Ctrl/Cmd-V"},pastetext:{exec:function(b){var c=this;var d=a('<form><div><label for="txt">Paste your text inside the followingbox:</label> <textarea cols="20" rows="7" id="txt"></textarea></div></form>').submit(function(){return false});d.append(a('<div><input type="button" class="button" value="Insert" /></div>').click(function(f){c.wysiwygEditorInsertText(a(this).parent("form").find("#txt").val());c.closeDropDown(true);f.preventDefault()}));c.createDropDown(b,"pastetext",d)},tooltip:"Paste Text"},bulletlist:{exec:"insertunorderedlist",tooltip:"Bullet list"},orderedlist:{exec:"insertorderedlist",tooltip:"Numbered list"},undo:{exec:"undo",tooltip:"Undo"},redo:{exec:"redo",tooltip:"Redo"},table:{exec:function(b){var c=this;var d=a('<form><div><label for="rows">Rows:</label><input type="text" id="rows" value="2" /></div><div><label for="cols">Cols:</label><input type="text" id="cols" value="2" /></div></form>').submit(function(){return false});d.append(a('<div><input type="button" class="button" value="Insert" /></div>').click(function(j){var h=a(this).parent("form").find("#rows").val()-0;var i=a(this).parent("form").find("#cols").val()-0;var g="<table>";for(var k=0;k<h;k++){g+="<tr>";for(var f=0;f<i;f++){if(a.browser.msie){g+="<td></td>"}else{g+='<td><br class="sceditor-ignore" /></td>'}}g+="</tr>"}g+="</table>";c.wysiwygEditorInsertHtml(g);c.closeDropDown(true);j.preventDefault()}));c.createDropDown(b,"inserttable",d)},tooltip:"Insert a table"},horizontalrule:{exec:"inserthorizontalrule",tooltip:"Insert a horizontal rule"},code:{exec:function(b){this.wysiwygEditorInsertHtml("<code>","<br /></code>")},tooltip:"Code"},image:{exec:function(b){var c=this;var d=a('<form><div><label for="link">URL:</label> <input type="text" id="image" value="http://" /></div><div><label for="width">Width (optional):</label> <input type="text" id="width" size="2" /></div><div><label for="height">Height (optional):</label> <input type="text" id="height" size="2" /></div></form>').submit(function(){return false});d.append(a('<div><input type="button" class="button" value="Insert" /></div>').click(function(j){var g=a(this).parent("form");var k=g.find("#image").val();var h="";var i,f;if((i=g.find("#width").val())!==""){h+=' width="'+i+'"'}if((f=g.find("#height").val())!==""){h+=' height="'+f+'"'}if(k!==""&&k!=="http://"){c.wysiwygEditorInsertHtml("<img"+h+' src="'+k+'" />')}c.closeDropDown(true);j.preventDefault()}));c.createDropDown(b,"insertimage",d)},tooltip:"Insert an image"},email:{exec:function(b){var c=this;var d=a('<form><div><label for="email">E-mail:</label> <input type="text" id="email" value="" /></div></form>').submit(function(){return false});d.append(a('<div><input type="button" class="button" value="Insert" /></div>').click(function(f){var g=a(this).parent("form").find("#email").val();if(g!==""){c.focus();if(c.getWysiwygSelectedHtml()==""){c.wysiwygEditorInsertHtml('<a href="mailto:'+g+'">'+g+"</a>")}else{c.execCommand("createlink","mailto:"+g)}}c.closeDropDown(true);f.preventDefault()}));c.createDropDown(b,"insertemail",d)},tooltip:"Insert an email"},link:{exec:function(b){var c=this;var d=a('<form><div><label for="link">URL:</label> <input type="text" id="link" value="http://" /></div></form>').submit(function(){return false});d.append(a('<div><input type="button" class="button" value="Insert" /></div>').click(function(f){var g=a(this).parent("form").find("#link").val();if(g!==""&&g!=="http://"){c.focus();if(c.getWysiwygSelectedHtml()==""){c.wysiwygEditorInsertHtml('<a href="'+g+'">'+g+"</a>")}else{c.execCommand("createlink",g)}}c.closeDropDown(true);f.preventDefault()}));c.createDropDown(b,"insertlink",d)},tooltip:"Insert a link"},unlink:{exec:"unlink",tooltip:"Unlink"},quote:{exec:function(b,c){c=c||"<br />";this.wysiwygEditorInsertHtml("<blockquote>"+c+"</blockquote>")},tooltip:"Insert a Quote"},emoticon:{exec:function(d){var f=this;var g=a("<div />");var b=a("<div />");var c=function(i,h){b.append(a("<img />").attr({src:h,alt:i}).click(function(j){f.wysiwygEditorInsertHtml('<img src="'+a(this).attr("src")+'" data-sceditor-emoticon="'+a(this).attr("alt")+'" />');f.closeDropDown(true);j.preventDefault()}));if(b.children().length>3){g.append(b);b=a("<div />")}};a.each(f.options.emoticons.dropdown,c);if(b.children().length>0){g.append(b)}if(typeof f.options.emoticons.more!=="undefined"){var e=a('<a class="sceditor-more">More</a>').click(function(){var h=a.extend({},f.options.emoticons.dropdown,f.options.emoticons.more);g=a("<div />");b=a("<div />");a.each(h,c);if(b.children().length>0){g.append(b)}f.createDropDown(d,"insertemoticon",g)});g.append(e)}f.createDropDown(d,"insertemoticon",g)},keyPress:function(f,g){var b=null,h=-1,d=this;if(g.contentWindow&&g.contentWindow.getSelection){b=g.contentWindow.getSelection().getRangeAt(0)}if(b==null||!b.startContainer){return}if(!d.allEmoticonCache){d.allEmoticonCache=a.extend({},d.options.emoticons.more,d.options.emoticons.dropdown,d.options.emoticons.hidden)}if(!d.longestEmoticonCode){d.longestEmoticonCode=0;a.each(d.allEmoticonCache,function(i,e){if(i.length>d.longestEmoticonCode){d.longestEmoticonCode=i.length}})}var c=b.startContainer.textContent.substr(0,b.startOffset)+String.fromCharCode(f.which)+b.startContainer.textContent.substr(b.startOffset,d.longestEmoticonCode);a.each(d.allEmoticonCache,function(i,e){if((h=c.indexOf(i))>-1){b=b.cloneRange();b.setStart(b.startContainer,h);b.setEnd(b.startContainer,h+(i.length-1));b.deleteContents();var j=g.contentDocument.createElement("div");j.innerHTML='<img src="'+e+'" data-sceditor-emoticon="'+i+'" />';j=j.children[0];b.insertNode(j);b=b.cloneRange();b.setStartAfter(j);g.contentWindow.getSelection().removeAllRanges();g.contentWindow.getSelection().addRange(b);f.preventDefault();f.stopPropagation();return false}})},tooltip:"Insert an emoticon"},youtube:{exec:function(b){var c=this;var d=a('<form><div><label for="link">Video URL:</label> <input type="text" id="link" value="http://" /></div></form>').submit(function(){return false});d.append(a('<div><input type="button" class="button" value="Insert" /></div>').click(function(f){var g=a(this).parent("form").find("#link").val();if(g!==""&&g!=="http://"){g=g.replace(/^[^v]+v.(.{11}).*/,"$1");c.wysiwygEditorInsertHtml('<iframe width="560" height="315" src="http://www.youtube.com/embed/'+g+'" data-youtube-id="'+g+'" frameborder="0" allowfullscreen></iframe>')}c.closeDropDown(true);f.preventDefault()}));c.createDropDown(b,"insertlink",d)},tooltip:"Insert a YouTube video"},date:{exec:function(d){var c=new Date();var e=c.getYear();var f=c.getMonth();var b=c.getDate();if(e<2000){e=1900+e}if(f<10){f="0"+f}if(b<10){b="0"+b}this.wysiwygEditorInsertHtml("<span>"+this.options.dateFormat.replace(/year/i,e).replace(/month/i,f).replace(/day/i,b)+"</span>")},tooltip:"Insert current date"},time:{exec:function(d){var c=new Date();var b=c.getHours();var f=c.getMinutes();var e=c.getSeconds();if(b<10){b="0"+b}if(f<10){f="0"+f}if(e<10){e="0"+e}this.wysiwygEditorInsertHtml("<span>"+b+":"+f+":"+e+"</span>")},tooltip:"Insert current time"},print:{exec:"print",tooltip:"Print"},source:{exec:function(b){this.toggleTextMode()},tooltip:"View source"}};a.sceditor.commandExists=function(b){return typeof a.sceditor.commands[b]!=="undefined"};a.sceditor.setCommand=function(d,b,e,c){if(!d||!b){return false}if(!a.sceditor.commandExists(d)){a.sceditor.commands[d]={}}a.sceditor.commands[d].exec=b;if(e){a.sceditor.commands[d].tooltip=e}if(c){a.sceditor.commands[d].keypress=c}return true};a.sceditor.defaultOptions={toolbar:"bold,italic,underline,strike,subscript,superscript|left,center,right,justify|font,size,color,removeformat|cut,copy,paste,pastetext|bulletlist,orderedlist|undo,redo|table|code,quote|horizontalrule,image,email,link,unlink|emoticon,youtube,date,time|print,source",style:"jquery.sceditor.default.css",fonts:"Arial,Arial Black,Comic Sans MS,Courier New,Georgia,Impact,Sans-serif,Serif,Times New Roman,Trebuchet MS,Verdana",colors:null,emoticons:{dropdown:{":)":"emoticons/smile.png",":angel:":"emoticons/angel.png",":angry:":"emoticons/angry.png","8-)":"emoticons/cool.png",":'(":"emoticons/cwy.png",":ermm:":"emoticons/ermm.png",":D":"emoticons/grin.png","<3":"emoticons/heart.png",":(":"emoticons/sad.png",":O":"emoticons/shocked.png",":P":"emoticons/tongue.png",";)":"emoticons/wink.png"},more:{":alien:":"emoticons/alien.png",":blink:":"emoticons/blink.png",":blush:":"emoticons/blush.png",":cheerful:":"emoticons/cheerful.png",":devil:":"emoticons/devil.png",":dizzy:":"emoticons/dizzy.png",":getlost:":"emoticons/getlost.png",":happy:":"emoticons/happy.png",":kissing:":"emoticons/kissing.png",":ninja:":"emoticons/ninja.png",":pinch:":"emoticons/pinch.png",":pouty:":"emoticons/pouty.png",":sick:":"emoticons/sick.png",":sideways:":"emoticons/sideways.png",":silly:":"emoticons/silly.png",":sleeping:":"emoticons/sleeping.png",":unsure:":"emoticons/unsure.png",":woot:":"emoticons/w00t.png",":wassat:":"emoticons/wassat.png"},hidden:{":whistling:":"emoticons/whistling.png",":love:":"emoticons/wub.png"}},width:null,height:null,resizeEnabled:true,resizeMinWidth:null,resizeMinHeight:null,resizeMaxHeight:null,resizeMaxWidth:null,getHtmlHandler:null,getTextHandler:null,dateFormat:"year-month-day",toolbarContainer:null};a.fn.sceditor=function(b){return this.each(function(){(new a.sceditor(this,b))})}})(jQuery);(function(a){a.sceditorBBCodePlugin=function(e,k){var c=this;var j,f,g,d,i;c.bbcodes=a.sceditorBBCodePlugin.bbcodes;var h={};var b={};j=function(){c.options=a.extend({},a.sceditor.defaultOptions,a.sceditorBBCodePlugin.defaultOptions,k);c.buildBbcodeCache();(new a.sceditor(e,a.extend({},c.options,{getHtmlHandler:c.getHtmlHandler,getTextHandler:c.getTextHandler})))};c.buildBbcodeCache=function(){a.each(c.bbcodes,function(l,m){if(typeof c.bbcodes[l].tags!=="undefined"){a.each(c.bbcodes[l].tags,function(n,o){h[n]=(h[n]||{});h[n][l]=o})}if(typeof c.bbcodes[l].styles!=="undefined"){a.each(c.bbcodes[l].styles,function(o,n){b[o]=(b[o]||{});b[o][l]=n})}})};f=function(m,n){var l;a.each(b,function(p,o){if(m.get(0).nodeName.toLowerCase()==="a"&&(p==="color"||p==="text-decoration")){return}else{if(m.get(0).nodeName.toLowerCase()==="code"&&(p==="font-family")){return}}l=m.css(p);if(m.parent().css(p)==l){return}a.each(o,function(r,q){if(q===null||a.inArray(l.toString(),q)>-1){if(a.isFunction(c.bbcodes[r].format)){n=c.bbcodes[r].format.call(c,m,n)}else{n=d(c.bbcodes[r].format,n)}}})});return n};g=function(m,n){var l=m.get(0).nodeName.toLowerCase();if(typeof h[l]!=="undefined"){a.each(h[l],function(p,q){if(q!==null){var o=false;a.each(q,function(s,r){if(typeof m.attr(s)==="undefined"){return}if(r!==null&&a.inArray(m.attr(s),r)<0){return}o=true;return false});if(!o){return}}if(a.isFunction(c.bbcodes[p].format)){n=c.bbcodes[p].format.call(c,m,n)}else{n=d(c.bbcodes[p].format,n)}})}if(l==="br"||l==="div"||l==="p"){n+="\n"}return n};d=function(){var l=arguments;return l[0].replace(/\{(\d+)\}/g,function(n,m){return typeof l[0-m+1]!="undefined"?l[0-m+1]:"{"+m+"}"})};c.stripQuotes=function(l){return l.replace(/^["']+/,"").replace(/["']+$/,"")};c.getHtmlHandler=function(l,m){return i(a(m))};i=function(m){var l="";if(typeof m.get(0)==="undefined"){return""}if(m.get(0).nodeName.toLowerCase()!=="iframe"){if(m.get(0).nodeType===3){return m.get(0).nodeValue}else{if(m.is("code")){l=m.text()}else{if(m.contents().length>0){a.each(m.contents(),function(){l+=i(a(this))})}}}}if(!m.is("code")){l=f(m,l)}l=g(m,l);return l};c.getTextHandler=function(p){var o=/\[([^\[\s=]*?)(?:([^\[]*?))?\]((?:[\s\S(?!=\[\\\1)](?!\[\1))*?)\[\/(\1)\]/g;var m=/(\S+)=((?:(?:(["'])(?:\\\3|[^\3])*?\3))|(?:[^'"\s]+))/g;var l;var n=function(v,r,q,t){var s={};if(typeof q!=="undefined"){var u;q=a.trim(q);if((q.charAt(0)=="="&&(q.split("=").length-1)<=1)||r==="url"){s.defaultAttr=c.stripQuotes(q.substr(1))}else{if(q.charAt(0)==="="){q="defaultAttr"+q}while((u=m.exec(q))){s[u[1].toLowerCase()]=c.stripQuotes(u[2])}}}if(typeof c.bbcodes[r]==="undefined"){return v}if(typeof c.bbcodes[r].html==="function"){return c.bbcodes[r].html.call(c,r,s,t)}else{return d(c.bbcodes[r].html,t)}};p=p.replace(/&/g,"&amp;");p=p.replace(/</g,"&lt;");p=p.replace(/>/g,"&gt;");p=p.replace(/\r/g,"");p=p.replace(/(\[\/?(?:left|center|right|justify)\])\n/g,"$1");p=p.replace(/\n/g,"<span><br /></span>");while(p!==l){l=p;p=p.replace(o,n)}p=p.replace(/\[hr\]/gi,"<hr>");return p.replace(/ {2}(?=([^<\>]*?<|[^<\>]*?$))/g," &nbsp;")};j()};a.sceditorBBCodePlugin.bbcodes={b:{styles:{"font-weight":["bold","bolder","401","700","800","900"]},format:"[b]{0}[/b]",html:"<strong>{0}</strong>"},i:{styles:{"font-style":["italic","oblique"]},format:"[i]{0}[/i]",html:"<em>{0}</em>"},u:{styles:{"text-decoration":["underline"]},format:"[u]{0}[/u]",html:"<u>{0}</u>"},s:{styles:{"text-decoration":["line-through"]},format:"[s]{0}[/s]",html:"<s>{0}</s>"},sub:{tags:{sub:null},format:"[sub]{0}[/sub]",html:"<sub>{0}</sub>"},sup:{tags:{sup:null},format:"[sup]{0}[/sup]",html:"<sup>{0}</sup>"},left:{styles:{"text-align":["left"]},format:"[left]{0}[/left]",html:'<div style="text-align: left">{0}</div>'},center:{styles:{"text-align":["center"]},format:"[center]{0}[/center]",html:'<div style="text-align: center">{0}</div>'},right:{styles:{"text-align":["right"]},format:"[right]{0}[/right]",html:'<div style="text-align: right">{0}</div>'},justify:{styles:{"text-align":["justify"]},format:"[justify]{0}[/justify]",html:'<div style="text-align: justify">{0}</div>'},font:{styles:{"font-family":null},format:function(b,c){if(b.css("font-family")==this.options.defaultFont){return c}return"[font="+this.stripQuotes(b.css("font-family"))+"]"+c+"[/font]"},html:function(c,b,d){return'<font face="'+b.defaultAttr+'">'+d+"</font>"}},size:{styles:{"font-size":null},format:function(c,d){var e=c.css("fontSize");var b=1;if(e==this.options.defaultSize){return d}if(e.indexOf("px")>-1){e=e.replace("px","")-0;if(e>12){b=2}if(e>15){b=3}if(e>17){b=4}if(e>23){b=5}if(e>31){b=6}if(e>47){b=7}}else{b=e}return"[size="+b+"]"+d+"[/size]"},html:function(c,b,d){return'<font size="'+b.defaultAttr+'">'+d+"</font>"}},color:{styles:{color:null},format:function(c,e){var d=function(h){var g;function f(i){i=parseInt(i,10);if(isNaN(i)){return"00"}i=Math.max(0,Math.min(i,255)).toString(16);return i.length<2?"0"+i:i}if((g=h.match(/rgb\((\d+),\s*?(\d+),\s*?(\d+)\)/i))){return"#"+f(g[1])+f(g[2]-0)+f(g[3]-0)}return h};var b=d(c.css("color"));if(b==this.options.defaultColor){return e}return"[color="+b+"]"+e+"[/color]"},html:function(c,b,d){return'<font color="'+b.defaultAttr+'">'+d+"</font>"}},ul:{tags:{ul:null},format:"[ul]{0}[/ul]",html:"<ul>{0}</ul>"},list:{html:"<ul>{0}</ul>"},ol:{tags:{ol:null},format:"[ol]{0}[/ol]",html:"<ol>{0}</ol>"},li:{tags:{li:null},format:"[li]{0}[/li]",html:"<li>{0}</li>"},"*":{html:"<li>{0}</li>"},table:{tags:{table:null},format:"[table]{0}[/table]",html:"<table>{0}</table>"},tr:{tags:{tr:null},format:"[tr]{0}[/tr]",html:"<tr>{0}</tr>"},th:{tags:{th:null},format:"[th]{0}[/th]",html:"<th>{0}</th>"},td:{tags:{td:null},format:"[td]{0}[/td]",html:'<td>{0}<br class="sceditor-ignore" /></td>'},emoticon:{tags:{img:{src:null,"data-sceditor-emoticon":null}},format:function(b,c){return b.attr("data-sceditor-emoticon")+c},html:"{0}"},horizontalrule:{tags:{hr:null},format:"[hr]{0}",html:"<hr />"},img:{tags:{img:{src:null}},format:function(b,c){if(typeof b.attr("data-sceditor-emoticon")!="undefined"){return c}var d="="+a(b).width()+"x"+a(b).height();return"[img"+d+"]"+b.attr("src")+"[/img]"},html:function(c,b,d){var f="";if(typeof b.width!="undefined"){f+=' width="'+b.width+'"'}if(typeof b.height!="undefined"){f+=' height="'+b.height+'"'}if(typeof b.defaultAttr!=="undefined"){var e=b.defaultAttr.split(/x/i);f=' width="'+e[0]+'" height="'+(e.length===2?e[1]:e[0])+'"'}return"<img "+f+' src="'+d+'" />'}},url:{tags:{a:{href:null}},format:function(b,c){if(b.attr("href").substr(0,7)=="mailto:"){return"[email="+b.attr("href").substr(7)+"]"+c+"[/email]"}return"[url="+encodeURI(b.attr("href"))+"]"+c+"[/url]"},html:function(c,b,d){if(typeof b.defaultAttr==="undefined"){b.defaultAttr=d}return'<a href="'+b.defaultAttr+'">'+d+"</a>"}},email:{html:function(c,b,d){if(typeof b.defaultAttr==="undefined"){b.defaultAttr=d}return'<a href="mailto:'+b.defaultAttr+'">'+d+"</a>"}},quote:{tags:{blockquote:null},format:function(c,d){var b="";if(a(c).children("cite:first").length==1){b="="+a(c).children("cite:first").text();d="";a(c).children("cite:first").remove();a(c).contents().each(function(){d+=elementToBbcode(a(this))})}return"[quote"+b+"]"+d+"[/quote]"},html:function(c,b,d){if(typeof b.defaultAttr!=="undefined"){d="<cite>"+b.defaultAttr+"</cite>"+d}return"<blockquote>"+d+"</blockquote>"}},code:{tags:{code:null},format:"[code]{0}[/code]",html:"<code>{0}</code>"},youtube:{tags:{iframe:{"data-youtube-id":null}},format:function(b,c){if(!b.attr("data-youtube-id")){return c}return"[youtube]"+b.attr("data-youtube-id")+"[/youtube]"},html:'<iframe width="560" height="315" src="http://www.youtube.com/embed/{0}" data-youtube-id="{0}" frameborder="0" allowfullscreen></iframe>'}};a.sceditorBBCodePlugin.commandExists=function(b){return typeof a.sceditorBBCodePlugin.bbcodes[b]!=="undefined"};a.sceditorBBCodePlugin.setCommand=function(c,b,e,f,d){if(!c||!f||!d){return false}if(!a.sceditorBBCodePlugin.commandExists(c)){a.sceditorBBCodePlugin.bbcodes[c]={}}a.sceditorBBCodePlugin.bbcodes[c].format=f;a.sceditorBBCodePlugin.bbcodes[c].html=d;if(b){a.sceditorBBCodePlugin.bbcodes[c].tags=b}if(e){a.sceditorBBCodePlugin.bbcodes[c].styles=e}return true};a.sceditorBBCodePlugin.defaultOptions={defaultSize:13,defaultColor:"#111111",defaultFont:"Verdana, Arial, Helvetica, sans-serif"};a.fn.sceditorBBCodePlugin=function(b){return this.each(function(){(new a.sceditorBBCodePlugin(this,b))})}})(jQuery);