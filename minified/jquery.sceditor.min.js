(function(d){d.sceditor=function(b,c){var a=this,f=d(b),e=null,h=null,g=null,i=null,j=null,m=null,p=!1,l=[],k=null,n=null,t=[],r,q,B,C,w,x,D,E,F,G,H,y,z,I,o,A,u,v,J,s;a.commands=d.sceditor.commands;E=function(){var b=d('<div contenteditable="true">')[0].contentEditable,b="undefined"!==typeof b&&"inherit"!==b;j=d("<textarea></textarea>").hide();g=d('<iframe frameborder="0"></iframe>');"https:"===window.location.protocol&&g.attr("src","javascript:false");e.append(g).append(j);i=g[0];v(f.width());u(f.height());
b||(o().designMode="On");o().open();o().write('<html><head><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><meta http-equiv="Content-Type" content="text/html;charset='+a.options.charset+'" /><link rel="stylesheet" type="text/css" href="'+a.options.style+'" /></head><body contenteditable="true"></body></html>');o().close();b||(o().designMode="On");d(o()).find("body").keypress(x);d(o()).keypress(x);d(o()).mousedown(D);d(o()).bind("beforedeactivate keypress",w);d(o()).focus(function(){k=
null})};F=function(){var b=function(b){C(d(this),a.commands[d(this).data("sceditor-command")]);b.preventDefault()};h=d('<div class="sceditor-toolbar" />');var c=a.options.toolbar.split("|"),f,l,k,g;for(g=0;g<c.length;g++){f=d('<div class="sceditor-group" />');l=c[g].split(",");for(var n=0;n<l.length;n++)a.commands.hasOwnProperty(l[n])&&(k=a.commands[l[n]].tooltip?a._(a.commands[l[n]].tooltip):l[n],k=d('<a class="sceditor-button sceditor-button-'+l[n]+' " unselectable="on"><div unselectable="on">'+
k+"</div></a>"),a.commands[l[n]].hasOwnProperty("tooltip")&&k.attr("title",a._(a.commands[l[n]].tooltip)),a.commands[l[n]].exec?k.data("sceditor-wysiwygmode",!0):k.addClass("disabled"),a.commands[l[n]].txtExec&&k.data("sceditor-txtmode",!0),k.data("sceditor-command",l[n]),k.click(b),f.append(k));h.append(f)}null===a.options.toolbarContainer?e.append(h):d(a.options.toolbarContainer).append(h)};G=function(){d.each(a.commands,function(a,d){"undefined"!==typeof d.keyPress&&l.push(d.keyPress)})};v=function(a){e.width(a);
g.width(a);g.width(a+(a-g.outerWidth(!0)));j.width(a);j.width(a+(a-j.outerWidth(!0)))};u=function(d){e.height(d);d-=null===a.options.toolbarContainer?h.outerHeight():0;g.height(d);g.height(d+(d-g.outerHeight(!0)));j.height(d);j.height(d+(d-j.outerHeight(!0)))};H=function(){var b=d('<div class="sceditor-grip" />'),c=d('<div class="sceditor-resize-cover" />'),f=0,l=0,k=0,h=0,g=e.width(),n=e.height(),t=!1,p,i,j,m,q;p=null==a.options.resizeMinHeight?n/2:a.options.resizeMinHeight;i=null==a.options.resizeMaxHeight?
2*n:a.options.resizeMaxHeight;j=null==a.options.resizeMinWidth?g/2:a.options.resizeMinWidth;m=null==a.options.resizeMaxWidth?2*g:a.options.resizeMaxWidth;q=function(a){var d=h+(a.pageY-l),b=k+(a.pageX-f);b>=j&&(0>m||b<=m)&&v(b);d>=p&&(0>i||d<=i)&&u(d);a.preventDefault()};e.append(b);e.append(c.hide());b.mousedown(function(a){f=a.pageX;l=a.pageY;k=e.width();h=e.height();t=!0;c.show();d(document).bind("mousemove",q);a.preventDefault()});d(document).mouseup(function(a){t&&(t=!1,c.hide(),d(document).unbind("mousemove",
q),a.preventDefault())})};z=function(b){a.updateTextareaValue();d(this).removeAttr("novalidate");this.checkValidity&&!this.checkValidity()&&b.preventDefault();d(this).attr("novalidate","novalidate")};a.destory=function(){d(document).unbind("click",y);f.removeAttr("novalidate").unbind("submit",z);d(window).unbind("resize",A);e.remove();e=null;f.removeData("sceditor").show()};I=function(){var b=d.extend({},a.options.emoticons.more,a.options.emoticons.dropdown,a.options.emoticons.hidden),c;d.each(b,
function(a,d){c=document.createElement("img");c.src=d;t.push(c)})};a.createDropDown=function(b,c,e,f){a.closeDropDown();!1!==f&&(e=d(e),e.find(":not(input,textarea)").filter(function(){return 1===this.nodeType}).attr("unselectable","on"));m=d('<div class="sceditor-dropdown sceditor-'+c+'" />').css({top:b.offset().top,left:b.offset().left}).append(e);m.appendTo(d("body"));p=!0;m.click(function(a){a.stopPropagation()})};y=function(d){!p&&3!==d.which&&a.closeDropDown();p=!1};a.closeDropDown=function(d){null!==
m&&(m.remove(),m=null);!0===d&&a.focus()};o=function(){return i.contentDocument?i.contentDocument:i.contentWindow&&i.contentWindow.document?i.contentWindow.document:i.document?i.document:null};a.wysiwygEditorInsertHtml=function(b,c,e){a.focus();if(e||!(d(r()).is("code")||0!==d(r()).parents("code").length)){"undefined"!==typeof c&&null!==c&&(b=b+a.getWysiwygSelectedHtml()+c);if(o().getSelection){c=q();e=o().createElement("div");e.innerHTML=b;e=e.children[0];c.deleteContents();c.insertNode(e);c=c.cloneRange();
if(e.parentNode!==c.startContainer||!d.browser.opera)c.setStartAfter(e);else return;i.contentWindow.getSelection().removeAllRanges();i.contentWindow.getSelection().addRange(c)}else o().selection&&o().selection.createRange?(o().selection.createRange().pasteHTML(b),w(),a.focus()):a.execCommand("insertHtml",b);k=null}};a.wysiwygEditorInsertText=function(d){d=d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ /g,"&nbsp;").replace(/\r\n|\r/g,"\n").replace(/\n/g,"<br />");a.wysiwygEditorInsertHtml("<span>"+
d+"</span>")};q=function(){var a;i.contentWindow&&i.contentWindow.getSelection?a=i.contentWindow.getSelection():document.selection&&(a=o().selection);a.getRangeAt&&0>=a.rangeCount&&a.addRange(o().createRange());return a.getRangeAt?a.getRangeAt(0):a.createRange?a.createRange():null};a.getWysiwygSelectedHtml=function(){var a=q();if(null===a)return"";if(document.selection&&document.selection.createRange){if(""===a.text)return"";if("undefined"!==typeof a.htmlText)return a.htmlText}if(window.XMLSerializer){var b=
"";d(a.cloneContents().childNodes).each(function(){b+=(new XMLSerializer).serializeToString(this)});return b}};r=function(){var a=q();if(null===a)return null;if(window.getSelection&&"undefined"!==typeof a.commonAncestorContainer)return a.commonAncestorContainer;if(document.selection&&document.selection.createRange)return a.parentElement()};a.getWysiwygEditorValue=function(b){var c=g.contents().find("body"),e;d.sceditor.dom.fixNesting(c.get(0));e=c.html();!1!==b&&a.options.getHtmlHandler&&(e=a.options.getHtmlHandler(e,
c));return e};a.getTextareaValue=function(d){var b=j.val();!1!==d&&a.options.getTextHandler&&(b=a.options.getTextHandler(b));return b};a.setWysiwygEditorValue=function(a){o().body.innerHTML=B(a)};a.setTextareaValue=function(a){j.val(a)};a.updateTextareaValue=function(){s()?f.val(a.getTextareaValue(!1)):f.val(a.getWysiwygEditorValue())};B=function(b){var c=d.extend({},a.options.emoticons.more,a.options.emoticons.dropdown,a.options.emoticons.hidden);d.each(c,function(d,c){var e=a.regexEscape(d)+"(?=([^\\<\\>]*?<(?!/code)|[^\\<\\>]*?$))",
f="";a.options.emoticonsCompat&&(e="((>|^|\\s){1})"+e+"(?=(\\s|$|<){1})",f="$1");b=b.replace(RegExp(e,"gm"),f+'<img src="'+c+'" data-sceditor-emoticon="'+d+'" alt="'+d+'" />')});return b};a.regexEscape=function(a){return a.replace(/[\$\?\[\]\.\*\(\)\|]/g,"\\$&").replace("<","&lt;").replace(">","&gt;")};s=function(){return j.is(":visible")};a.toggleTextMode=function(){s()?a.setWysiwygEditorValue(a.getTextareaValue()):a.setTextareaValue(a.getWysiwygEditorValue());h.find(".sceditor-button").removeClass("disabled");
k=null;j.toggle();g.toggle();h.find(".sceditor-button").each(function(){var a=d(this);s()&&!a.data("sceditor-txtmode")?a.addClass("disabled"):!s()&&!a.data("sceditor-wysiwygmode")&&a.addClass("disabled")})};C=function(b,c){s()?c.hasOwnProperty("txtExec")&&c.txtExec.call(a,b):c.hasOwnProperty("exec")&&(d.isFunction(c.exec)?c.exec.call(a,b):a.execCommand(c.exec,c.hasOwnProperty("execParam")?c.execParam:null))};a.focus=function(){i.contentWindow.focus();null!==k&&(window.document.createRange?window.getSelection().addRange(k):
window.document.selection&&k.select(),k=null)};w=function(){d.browser.msie&&(k=q())};a.execCommand=function(b,c){var e=!1;a.focus();if(!(d(r()).is("code")||0!==d(r()).parents("code").length)){if(o())try{e=o().execCommand(b,!1,c)}catch(f){}!e&&"undefined"!==typeof a.commands[b]&&"undefined"!==typeof a.commands[b].errorMessage&&alert(a._(a.commands[b].errorMessage))}};x=function(b){a.closeDropDown();var c=r(),c=d(c);if(13===b.which&&(c.is("code, blockquote")||0!==c.parents("code, blockquote").length))return k=
null,a.wysiwygEditorInsertHtml("<br />",null,!0),!1;var e=o();d.sceditor.dom.rTraverse(e.body,function(a){if(3===a.nodeType&&""!==a.nodeValue||"br"===a.nodeName.toLowerCase())return 0<d(a).parents("code, blockquote").length&&d(e.body).append(e.createElement("br")),!1},!0);if(!(c.is("code")||0!==c.parents("code").length))for(c=l.length;c--;)l[c].call(a,b,i,j)};D=function(){a.closeDropDown();k=null};A=function(){null!==a.options.height&&-1<a.options.height.toString().indexOf("%")&&u(e.parent().height()*
(parseFloat(a.options.height)/100));null!==a.options.width&&-1<a.options.width.toString().indexOf("%")&&v(e.parent().width()*(parseFloat(a.options.width)/100))};a._=function(){var a=arguments;null!==n&&n[a[0]]&&(a[0]=n[a[0]]);return a[0].replace(/\{(\d+)\}/g,function(b,c){return"undefined"!==typeof a[c-0+1]?a[c-0+1]:"{"+c+"}"})};J=function(){if(d.sceditor.locale[a.options.locale])n=d.sceditor.locale[a.options.locale];else{var c=a.options.locale.split("-");d.sceditor.locale[c[0]]&&(n=d.sceditor.locale[c[0]])}null!==
n&&n.dateFormat&&(a.options.dateFormat=n.dateFormat)};(function(){f.data("sceditor",a);a.options=d.extend({},d.sceditor.defaultOptions,c);null!==a.options.locale&&"en"!==a.options.locale&&J();null!==a.options.height&&f.height(a.options.height);null!==a.options.width&&f.width(a.options.width);(null!==a.options.height&&-1<a.options.height.toString().indexOf("%")||null!==a.options.width&&-1<a.options.width.toString().indexOf("%"))&&d(window).resize(A);e=d('<div class="sceditor-container" />').width(f.outerWidth()).height(f.outerHeight());
f.after(e);F();E();G();a.options.resizeEnabled&&H();d(document).click(y);f.parents("form").attr("novalidate","novalidate").submit(z);var b=f.hide().val();a.options.getTextHandler&&(b=a.options.getTextHandler(b));a.setWysiwygEditorValue(b);-1!==a.options.toolbar.indexOf("emoticon")&&I()})()};d.sceditor.locale={};d.sceditor.commands={bold:{exec:"bold",tooltip:"Bold"},italic:{exec:"italic",tooltip:"Italic"},underline:{exec:"underline",tooltip:"Underline"},strike:{exec:"strikethrough",tooltip:"Strikethrough"},
subscript:{exec:"subscript",tooltip:"Subscript"},superscript:{exec:"superscript",tooltip:"Superscript"},left:{exec:"justifyleft",tooltip:"Align left"},center:{exec:"justifycenter",tooltip:"Center"},right:{exec:"justifyright",tooltip:"Align right"},justify:{exec:"justifyfull",tooltip:"Justify"},font:{exec:function(b){for(var c=this,a=c.options.fonts.split(","),f=d("<div />"),e=function(a){c.execCommand("fontname",d(this).data("sceditor-font"));c.closeDropDown(!0);a.preventDefault()},h=0;h<a.length;h++)f.append(d('<a class="sceditor-font-option" href="#"><font face="'+
a[h]+'">'+a[h]+"</font></a>").data("sceditor-font",a[h]).click(e));c.createDropDown(b,"font-picker",f)},tooltip:"Font Name"},size:{exec:function(b){for(var c=this,a=d("<div />"),f=function(a){c.execCommand("fontsize",d(this).data("sceditor-fontsize"));c.closeDropDown(!0);a.preventDefault()},e=1;7>=e;e++)a.append(d('<a class="sceditor-fontsize-option" href="#"><font size="'+e+'">'+e+"</font></a>").data("sceditor-fontsize",e).click(f));c.createDropDown(b,"fontsize-picker",a)},tooltip:"Font Size"},color:{exec:function(b){for(var c=
this,a={r:255,g:255,b:255},f=d("<div />"),e=this.options.colors?this.options.colors.split("|"):Array(21),h=[],g=0,i=0;i<e.length;++i){var j="undefined"!==typeof e[i]?e[i].split(","):Array(21);h[g++]='<div class="sceditor-color-column">';for(var m=0;m<j.length;++m){var p="undefined"!==typeof j[m]?j[m]:"#"+a.r.toString(16)+a.g.toString(16)+a.b.toString(16);h[g++]='<a href="#" class="sceditor-color-option" style="background-color: '+p+'" data-color="'+p+'"></a>';a=0===m%5?{r:a.r,g:a.g-51,b:255}:{r:a.r,
g:a.g,b:a.b-51}}h[g++]="</div>";a=0===i%5?{r:a.r-51,g:255,b:255}:{r:a.r,g:255,b:255}}f.append(h.join("")).find("a").click(function(a){c.execCommand("forecolor",d(this).attr("data-color"));c.closeDropDown(!0);a.preventDefault()});c.createDropDown(b,"color-picker",f)},tooltip:"Font Color"},removeformat:{exec:"removeformat",tooltip:"Remove Formatting"},cut:{exec:"cut",tooltip:"Cut",errorMessage:"Your browser does not allow the cut command. Please use the keyboard shortcut Ctrl/Cmd-X"},copy:{exec:"copy",
tooltip:"Copy",errorMessage:"Your browser does not allow the copy command. Please use the keyboard shortcut Ctrl/Cmd-C"},paste:{exec:"paste",tooltip:"Paste",errorMessage:"Your browser does not allow the paste command. Please use the keyboard shortcut Ctrl/Cmd-V"},pastetext:{exec:function(b){var c=this,a=d(this._('<form><div><label for="txt">{0}</label> <textarea cols="20" rows="7" id="txt"></textarea></div></form>',this._("Paste your text inside the following box:"))).submit(function(){return!1});
a.append(d(this._('<div><input type="button" class="button" value="{0}" /></div>',this._("Insert"))).click(function(a){c.wysiwygEditorInsertText(d(this).parent("form").find("#txt").val());c.closeDropDown(!0);a.preventDefault()}));c.createDropDown(b,"pastetext",a)},tooltip:"Paste Text"},bulletlist:{exec:"insertunorderedlist",tooltip:"Bullet list"},orderedlist:{exec:"insertorderedlist",tooltip:"Numbered list"},table:{exec:function(b){var c=this,a=d(this._('<form><div><label for="rows">{0}</label><input type="text" id="rows" value="2" /></div><div><label for="cols">{1}</label><input type="text" id="cols" value="2" /></div></form>',
this._("Rows:"),this._("Cols:"))).submit(function(){return!1});a.append(d(this._('<div><input type="button" class="button" value="{0}" /></div>',this._("Insert"))).click(function(a){var b=d(this).parent("form").find("#rows").val()-0,h=d(this).parent("form").find("#cols").val()-0,g="<table>";if(!(1>b||1>h)){for(var i=0;i<b;i++){for(var g=g+"<tr>",j=0;j<h;j++)g=d.browser.msie?g+"<td></td>":g+'<td><br class="sceditor-ignore" /></td>';g+="</tr>"}c.wysiwygEditorInsertHtml(g+"</table>");c.closeDropDown(!0);
a.preventDefault()}}));c.createDropDown(b,"inserttable",a)},tooltip:"Insert a table"},horizontalrule:{exec:"inserthorizontalrule",tooltip:"Insert a horizontal rule"},code:{exec:function(){this.wysiwygEditorInsertHtml("<code>","<br /></code>")},tooltip:"Code"},image:{exec:function(b){var c=this,a=d(this._('<form><div><label for="link">{0}</label> <input type="text" id="image" value="http://" /></div><div><label for="width">{1}</label> <input type="text" id="width" size="2" /></div><div><label for="height">{2}</label> <input type="text" id="height" size="2" /></div></form>',
this._("URL:"),this._("Width (optional):"),this._("Height (optional):"))).submit(function(){return!1});a.append(d(this._('<div><input type="button" class="button" value="Insert" /></div>',this._("Insert"))).click(function(a){var b=d(this).parent("form"),h=b.find("#image").val(),g="",i;if(i=b.find("#width").val())g+=' width="'+i+'"';if(b=b.find("#height").val())g+=' height="'+b+'"';h&&"http://"!==h&&c.wysiwygEditorInsertHtml("<img"+g+' src="'+h+'" />');c.closeDropDown(!0);a.preventDefault()}));c.createDropDown(b,
"insertimage",a)},tooltip:"Insert an image"},email:{exec:function(b){var c=this,a=d(this._('<form><div><label for="email">{0}</label> <input type="text" id="email" value="" /></div></form>',this._("E-mail:"))).submit(function(){return!1});a.append(d('<div><input type="button" class="button" value="Insert" /></div>').click(function(a){var b=d(this).parent("form").find("#email").val();b&&(c.focus(),c.getWysiwygSelectedHtml()?c.execCommand("createlink","mailto:"+b):c.wysiwygEditorInsertHtml('<a href="mailto:'+
b+'">'+b+"</a>"));c.closeDropDown(!0);a.preventDefault()}));c.createDropDown(b,"insertemail",a)},tooltip:"Insert an email"},link:{exec:function(b){var c=this,a=d(this._('<form><div><label for="link">{0}</label> <input type="text" id="link" value="http://" /></div><div><label for="des">{1}</label> <input type="text" id="des" value="" /></div></form>',this._("URL:"),this._("Description (optional):"))).submit(function(){return!1});a.append(d(this._('<div><input type="button" class="button" value="{0}" /></div>',
this._("Insert"))).click(function(a){var b=d(this).parent("form").find("#link").val(),h=d(this).parent("form").find("#des").val();""!==b&&"http://"!==b&&(c.focus(),!c.getWysiwygSelectedHtml()||h?(h||(h=b),c.wysiwygEditorInsertHtml('<a href="'+b+'">'+h+"</a>")):c.execCommand("createlink",b));c.closeDropDown(!0);a.preventDefault()}));c.createDropDown(b,"insertlink",a)},tooltip:"Insert a link"},unlink:{exec:"unlink",tooltip:"Unlink"},quote:{exec:function(b,c,a){var b="<blockquote>",d="</blockquote>";
c?(b=b+(a?"<cite>"+a+"</cite>":"")+c+d+"<br />",d=null):""===this.getWysiwygSelectedHtml()&&(d="<br />"+d);this.wysiwygEditorInsertHtml(b,d)},tooltip:"Insert a Quote"},emoticon:{exec:function(b){var c,a=this,f=d("<div />"),e=d("<div />");c=function(b,c){e.append(d("<img />").attr({src:c,alt:b}).click(function(b){var c="",e="";a.options.emoticonsCompat&&(c="<span> ",e=" </span>");a.wysiwygEditorInsertHtml(c+'<img src="'+d(this).attr("src")+'" data-sceditor-emoticon="'+d(this).attr("alt")+'" />'+e);
a.closeDropDown(!0);b.preventDefault()}));3<e.children().length&&(f.append(e),e=d("<div />"))};d.each(a.options.emoticons.dropdown,c);0<e.children().length&&f.append(e);if("undefined"!==typeof a.options.emoticons.more){var h=d(this._('<a class="sceditor-more">{0}</a>',this._("More"))).click(function(){var h=d.extend({},a.options.emoticons.dropdown,a.options.emoticons.more);f=d("<div />");e=d("<div />");d.each(h,c);0<e.children().length&&f.append(e);a.createDropDown(b,"insertemoticon",f)});f.append(h)}a.createDropDown(b,
"insertemoticon",f)},keyPress:function(b,c){var a=null,f=-1,e=this;c.contentWindow&&c.contentWindow.getSelection&&(a=c.contentWindow.getSelection().getRangeAt(0));if(null!=a&&a.startContainer){e.allEmoticonCache||(e.allEmoticonCache=d.extend({},e.options.emoticons.more,e.options.emoticons.dropdown,e.options.emoticons.hidden));e.longestEmoticonCode||(e.longestEmoticonCode=0,d.each(e.allEmoticonCache,function(a){a.length>e.longestEmoticonCode&&(e.longestEmoticonCode=a.length)}),e.options.emoticonsCompat&&
(e.longestEmoticonCode+=1));var h=String.fromCharCode(b.which),g=e.options.emoticonsCompat?/\s/.test(h):!1,i=a.startContainer.textContent.substr(0,a.startOffset),j=a.startContainer.textContent.substr(a.startOffset,e.longestEmoticonCode),m=i+h+j;d.each(e.allEmoticonCache,function(d,l){if(-1<(f=m.indexOf(d,a.startOffset-d.length))){if(e.options.emoticonsCompat){var k=RegExp("(\\s{1})"+e.regexEscape(d)+"(?=\\s{1})","gm");if(g&&-1<(h+j).indexOf(d)||!k.test(m))return}a=a.cloneRange();a.setStart(a.startContainer,
f);a.setEnd(a.startContainer,f+d.length-(g?0:1));a.deleteContents();k=c.contentDocument.createElement("div");k.innerHTML='<img src="'+l+'" data-sceditor-emoticon="'+d+'" alt="'+d+'" />';k=k.children[0];a.insertNode(k);a=a.cloneRange();a.setStartAfter(k);c.contentWindow.getSelection().removeAllRanges();c.contentWindow.getSelection().addRange(a);g||(b.preventDefault(),b.stopPropagation());return!1}})}},tooltip:"Insert an emoticon"},youtube:{exec:function(b){var c=this,a=d(this._('<form><div><label for="link">{0}</label> <input type="text" id="link" value="http://" /></div></form>',
this._("Video URL:"))).submit(function(){return!1});a.append(d(this._('<div><input type="button" class="button" value="{0}" /></div>',this._("Insert"))).click(function(a){var b=d(this).parent("form").find("#link").val();""!==b&&"http://"!==b&&(b=b.replace(/^[^v]+v.(.{11}).*/,"$1"),c.wysiwygEditorInsertHtml('<iframe width="560" height="315" src="http://www.youtube.com/embed/'+b+'?wmode=opaque" data-youtube-id="'+b+'" frameborder="0" allowfullscreen></iframe>'));c.closeDropDown(!0);a.preventDefault()}));
c.createDropDown(b,"insertlink",a)},tooltip:"Insert a YouTube video"},date:{exec:function(){var b=new Date,c=b.getYear(),a=b.getMonth()+1,b=b.getDate();2E3>c&&(c=1900+c);10>a&&(a="0"+a);10>b&&(b="0"+b);this.wysiwygEditorInsertHtml("<span>"+this.options.dateFormat.replace(/year/i,c).replace(/month/i,a).replace(/day/i,b)+"</span>")},tooltip:"Insert current date"},time:{exec:function(){var b=new Date,c=b.getHours(),a=b.getMinutes(),b=b.getSeconds();10>c&&(c="0"+c);10>a&&(a="0"+a);10>b&&(b="0"+b);this.wysiwygEditorInsertHtml("<span>"+
c+":"+a+":"+b+"</span>")},tooltip:"Insert current time"},print:{exec:"print",tooltip:"Print"},source:{exec:function(){this.toggleTextMode()},txtExec:function(){this.toggleTextMode()},tooltip:"View source"},ignore:{}};d.sceditor.dom={traverse:function(b,c,a,d,e){if(b)for(b=e?b.lastChild:b.firstChild;null!=b;){if(!a&&!1===c(b)||!d&&!1===this.traverse(b,c,a,d,e)||a&&!1===c(b))return!1;b=e?b.previousSibling:b.nextSibling}},rTraverse:function(b,d,a,f){this.traverse(b,d,a,f,!0)},isInline:function(b,d){if(null==
b||1!==b.nodeType)return!0;var a=(window.getComputedStyle?window.getComputedStyle(b):b.currentStyle).display;return d?"block"!==a:"inline"===a},copyCSS:function(b,d){d.style.cssText=b.style.cssText},fixNesting:function(b){var d=this;d.traverse(b,function(a){if(1===a.nodeType&&!d.isInline(a)&&d.isInline(a.parentNode)){var b;for(b=a;d.isInline(b.parentNode);)b=b.parentNode;var e=b.parentNode,h=d.extractContents(b,a);d.copyCSS(a,a);e.insertBefore(h,b);e.insertBefore(a,b)}})},findCommonAncestor:function(b,
c){return d(b).parents().has(d(c)).first()},removeWhiteSpace:function(b){var c=/[^\S|\u00A0]+/g;this.traverse(b,function(a){3===a.nodeType&&0===d(a).parents("code, pre").length&&(/\S|\u00A0/.test(a.nodeValue)?c.test(a.nodeValue)&&(a.nodeValue=a.nodeValue.replace(c," ")):a.nodeValue=" ")})},extractContents:function(b,d){var a=this,f=a.findCommonAncestor(b,d),e=!1,h=!1;return function i(f){var m=b.ownerDocument.createDocumentFragment();a.traverse(f,function(a){if(h||a===d&&e)return h=!0,!1;a===b&&(e=
!0);var l;e?(jQuery.contains(a,d)&&1===a.nodeType&&(l=i(a),a=a.cloneNode(!1),a.appendChild(l)),m.appendChild(a)):jQuery.contains(a,b)&&1===a.nodeType&&(l=i(a),a=a.cloneNode(!1),a.appendChild(l),m.appendChild(a))});return m}(null===f?null:f.get(0))}};d.sceditor.commandExists=function(b){return"undefined"!==typeof d.sceditor.commands[b]};d.sceditor.setCommand=function(b,c,a,f){if(!b||!c)return!1;d.sceditor.commandExists(b)||(d.sceditor.commands[b]={});d.sceditor.commands[b].exec=c;a&&(d.sceditor.commands[b].tooltip=
a);f&&(d.sceditor.commands[b].keyPress=f);return!0};d.sceditor.defaultOptions={toolbar:"bold,italic,underline,strike,subscript,superscript|left,center,right,justify|font,size,color,removeformat|cut,copy,paste,pastetext|bulletlist,orderedlist|table|code,quote|horizontalrule,image,email,link,unlink|emoticon,youtube,date,time|print,source",style:"jquery.sceditor.default.css",fonts:"Arial,Arial Black,Comic Sans MS,Courier New,Georgia,Impact,Sans-serif,Serif,Times New Roman,Trebuchet MS,Verdana",colors:null,
locale:"en",charset:"utf-8",emoticonsCompat:!1,emoticons:{dropdown:{":)":"emoticons/smile.png",":angel:":"emoticons/angel.png",":angry:":"emoticons/angry.png","8-)":"emoticons/cool.png",":'(":"emoticons/cwy.png",":ermm:":"emoticons/ermm.png",":D":"emoticons/grin.png","<3":"emoticons/heart.png",":(":"emoticons/sad.png",":O":"emoticons/shocked.png",":P":"emoticons/tongue.png",";)":"emoticons/wink.png"},more:{":alien:":"emoticons/alien.png",":blink:":"emoticons/blink.png",":blush:":"emoticons/blush.png",
":cheerful:":"emoticons/cheerful.png",":devil:":"emoticons/devil.png",":dizzy:":"emoticons/dizzy.png",":getlost:":"emoticons/getlost.png",":happy:":"emoticons/happy.png",":kissing:":"emoticons/kissing.png",":ninja:":"emoticons/ninja.png",":pinch:":"emoticons/pinch.png",":pouty:":"emoticons/pouty.png",":sick:":"emoticons/sick.png",":sideways:":"emoticons/sideways.png",":silly:":"emoticons/silly.png",":sleeping:":"emoticons/sleeping.png",":unsure:":"emoticons/unsure.png",":woot:":"emoticons/w00t.png",
":wassat:":"emoticons/wassat.png"},hidden:{":whistling:":"emoticons/whistling.png",":love:":"emoticons/wub.png"}},width:null,height:null,resizeEnabled:!0,resizeMinWidth:null,resizeMinHeight:null,resizeMaxHeight:null,resizeMaxWidth:null,getHtmlHandler:null,getTextHandler:null,dateFormat:"year-month-day",toolbarContainer:null};d.fn.sceditor=function(b){return this.each(function(){new d.sceditor(this,b)})}})(jQuery);(function(d){d.sceditorBBCodePlugin=function(b,c){var a=this,f,e,h,g,i;a.bbcodes=d.sceditorBBCodePlugin.bbcodes;var j={},m={},p={ul:["li"],ol:["li"],table:["tr"],tr:["td","th"],code:["br","p","div"],youtube:[]};g=function(a,b){var c=d.camelCase(b),e;return"text-align"===b&&(e=d(a),e.parent().css(b)!==e.css(b)&&"block"===e.css("display")&&!e.is("hr")&&!e.is("th"))?e.css(b):a.style?a.style[c]:null};f=function(b,c,e){var f;b[0].nodeName.toLowerCase();e=!!e;if(!m[e])return c;d.each(m[e],function(e,n){f=
g(b[0],e);null==f||""===f||g(b.parent()[0],e)===f||d.each(n,function(e,g){if(null===g||-1<d.inArray(f.toString(),g))c=d.isFunction(a.bbcodes[e].format)?a.bbcodes[e].format.call(a,b,c):h(a.bbcodes[e].format,c)})});return c};e=function(b,c,e){var f=b.get(0).nodeName.toLowerCase(),e=!!e;j[f]&&j[f][e]&&d.each(j[f][e],function(e,f){if(null!==f){var g=!1;d.each(f,function(a,c){if(!(null==b.attr(a)||null!==c&&0>d.inArray(b.attr(a),c)))return g=!0,!1});if(!g)return}c=d.isFunction(a.bbcodes[e].format)?a.bbcodes[e].format.call(a,
b,c):h(a.bbcodes[e].format,c)});e&&/^(br|div|p)$/.test(f)&&(e=b[0].parentNode.childNodes,!("br"===f&&1===e.length)&&!("br"===f&&e[e.length-1]===b[0])&&(c+="\n"),"br"!==f&&!d.sceditor.dom.isInline(b.parent()[0])&&b[0].previousSibling&&3===b[0].previousSibling.nodeType&&(c="\n"+c));return c};h=function(){var a=arguments;return a[0].replace(/\{(\d+)\}/g,function(b,d){return"undefined"!==typeof a[d-0+1]?a[d-0+1]:"{"+d+"}"})};a.stripQuotes=function(a){return a.replace(/^["']+/,"").replace(/["']+$/,"")};
a.getHtmlHandler=function(b,c){d.sceditor.dom.removeWhiteSpace(c[0]);return d.trim(a.elementToBbcode(c))};a.elementToBbcode=function(a){return function n(a,b){var c="";d.sceditor.dom.traverse(a,function(a){var h=d(a),g="",l=a.nodeName.toLowerCase(),i=p[l],j=!0;"object"===typeof b&&((j=-1<d.inArray(l,b))||(i=b));3!==a.nodeType?h.hasClass("sceditor-ignore")||("iframe"!==l&&(g=n(a,i)),j?(h.is("code")||(g=f(h,g),g=e(h,g),g=f(h,g,!0)),c+=e(h,g,!0)):c+=g):c+=a.nodeValue},!1,!0);return c}(a.get(0))};a.getTextHandler=
function(b){var c,e,f=/\[([^\[\s=]*?)(?:([^\[]*?))?\]((?:[\s\S(?!=\[\\\1)](?!\[\1))*?)\[\/(\1)\]/g,g=/(\S+)=((?:(?:(["'])(?:\\\3|[^\3])*?\3))|(?:[^'"\s]+))/g;e=function(b,c,e,f){var l={},k;if(e)if(e=d.trim(e),"="===e.charAt(0)&&1>=e.split("=").length-1||"url"===c)l.defaultAttr=a.stripQuotes(e.substr(1));else for("="===e.charAt(0)&&(e="defaultAttr"+e);k=g.exec(e);)l[k[1].toLowerCase()]=a.stripQuotes(k[2]);return!a.bbcodes[c]?b:d.isFunction(a.bbcodes[c].html)?a.bbcodes[c].html.call(a,c,l,f):h(a.bbcodes[c].html,
f)};for(b=b.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"").replace(/(\[\/?(?:left|center|right|justify)\])\n/g,"$1").replace(/\n/g,"<br />");b!==c;)c=b,b=b.replace(f,e);b=b.replace(/\[hr\]/gi,"<hr>");b=b.replace(/ {2}(?=([^<\>]*?<|[^<\>]*?$))/g," &nbsp;");return i(b)};i=function(a){var b=document,c=b.createDocumentFragment(),e=b.createElement("div"),f=b.createElement("div"),g=!1,h;d(f).hide().appendTo(b.body);f.innerHTML=a;for(a=f.firstChild;a;)f=a.nextSibling,h=
a.nodeName.toLowerCase(),1===a.nodeType&&!d.sceditor.dom.isInline(a)||"br"===h?(0<c.childNodes.length&&(g=b.createElement("div"),g.appendChild(c),e.appendChild(g),c=b.createDocumentFragment(),g=!0),(!g||"br"!==h)&&e.appendChild(a),g=!1):c.appendChild(a),a=f;0<c.childNodes.length&&(g=b.createElement("div"),g.appendChild(c),e.appendChild(g));return e.innerHTML};d.data(b,"sceditorbbcode",a);a.options=d.extend({},d.sceditor.defaultOptions,c);(function(){d.each(a.bbcodes,function(b){"undefined"!==typeof a.bbcodes[b].tags&&
d.each(a.bbcodes[b].tags,function(c,d){var e=!!a.bbcodes[b].isBlock;j[c]=j[c]||{};j[c][e]=j[c][e]||{};j[c][e][b]=d});"undefined"!==typeof a.bbcodes[b].styles&&d.each(a.bbcodes[b].styles,function(c,d){var e=!!a.bbcodes[b].isBlock;m[e]=m[e]||{};m[e][c]=m[e][c]||{};m[e][c][b]=d})})})();new d.sceditor(b,d.extend({},a.options,{getHtmlHandler:a.getHtmlHandler,getTextHandler:a.getTextHandler}))};d.sceditorBBCodePlugin.bbcodes={b:{tags:{b:null,strong:null},styles:{"font-weight":"bold,bolder,401,700,800,900".split(",")},
format:"[b]{0}[/b]",html:"<strong>{0}</strong>"},i:{tags:{i:null,em:null},styles:{"font-style":["italic","oblique"]},format:"[i]{0}[/i]",html:"<em>{0}</em>"},u:{tags:{u:null},styles:{"text-decoration":["underline"]},format:"[u]{0}[/u]",html:"<u>{0}</u>"},s:{tags:{s:null,strike:null},styles:{"text-decoration":["line-through"]},format:"[s]{0}[/s]",html:"<s>{0}</s>"},sub:{tags:{sub:null},format:"[sub]{0}[/sub]",html:"<sub>{0}</sub>"},sup:{tags:{sup:null},format:"[sup]{0}[/sup]",html:"<sup>{0}</sup>"},
font:{tags:{font:{face:null}},styles:{"font-family":null},format:function(b,c){return"font"===b[0].nodeName.toLowerCase()&&b.attr("face")?"[font="+this.stripQuotes(b.attr("face"))+"]"+c+"[/font]":"[font="+this.stripQuotes(b.css("font-family"))+"]"+c+"[/font]"},html:function(b,c,a){return'<font face="'+c.defaultAttr+'">'+a+"</font>"}},size:{tags:{font:{size:null}},styles:{"font-size":null},format:function(b,c){var a=b.css("fontSize"),d=1;-1<a.indexOf("px")?(a=a.replace("px","")-0,12<a&&(d=2),15<a&&
(d=3),17<a&&(d=4),23<a&&(d=5),31<a&&(d=6),47<a&&(d=7)):d=a;return"[size="+d+"]"+c+"[/size]"},html:function(b,c,a){return'<font size="'+c.defaultAttr+'">'+a+"</font>"}},color:{tags:{font:{color:null}},styles:{color:null},format:function(b,c){var a=b.css("color");"font"===b[0].nodeName.toLowerCase()&&b.attr("color")&&(a=b.attr("color"));a=function(a){function b(a){a=parseInt(a,10);if(isNaN(a))return"00";a=Math.max(0,Math.min(a,255)).toString(16);return 2>a.length?"0"+a:a}var c;return(c=a.match(/rgb\((\d+),\s*?(\d+),\s*?(\d+)\)/i))?
"#"+b(c[1])+b(c[2]-0)+b(c[3]-0):(c=a.match(/#([0-f])([0-f])([0-f])\s*?$/i))?"#"+c[1]+c[1]+c[2]+c[2]+c[3]+c[3]:a}(a);return"[color="+a+"]"+c+"[/color]"},html:function(b,c,a){return'<font color="'+c.defaultAttr+'">'+a+"</font>"}},ul:{tags:{ul:null},isBlock:!0,format:"[ul]{0}[/ul]",html:"<ul>{0}</ul>"},list:{html:"<ul>{0}</ul>"},ol:{tags:{ol:null},isBlock:!0,format:"[ol]{0}[/ol]",html:"<ol>{0}</ol>"},li:{tags:{li:null},format:"[li]{0}[/li]",html:"<li>{0}</li>"},"*":{html:"<li>{0}</li>"},table:{tags:{table:null},
format:"[table]{0}[/table]",html:"<table>{0}</table>"},tr:{tags:{tr:null},format:"[tr]{0}[/tr]",html:"<tr>{0}</tr>"},th:{tags:{th:null},isBlock:!0,format:"[th]{0}[/th]",html:"<th>{0}</th>"},td:{tags:{td:null},isBlock:!0,format:"[td]{0}[/td]",html:'<td>{0}<br class="sceditor-ignore" /></td>'},emoticon:{tags:{img:{src:null,"data-sceditor-emoticon":null}},format:function(b,c){return b.attr("data-sceditor-emoticon")+c},html:"{0}"},horizontalrule:{tags:{hr:null},format:"[hr]{0}",html:"<hr />"},img:{tags:{img:{src:null}},
format:function(b,c){return"undefined"!==typeof b.attr("data-sceditor-emoticon")?c:"[img"+("="+d(b).width()+"x"+d(b).height())+"]"+b.attr("src")+"[/img]"},html:function(b,c,a){b="";"undefined"!==typeof c.width&&(b+=' width="'+c.width+'"');"undefined"!==typeof c.height&&(b+=' height="'+c.height+'"');"undefined"!==typeof c.defaultAttr&&(c=c.defaultAttr.split(/x/i),b=' width="'+c[0]+'" height="'+(2===c.length?c[1]:c[0])+'"');return"<img "+b+' src="'+a+'" />'}},url:{tags:{a:{href:null}},format:function(b,
c){return"mailto:"===b.attr("href").substr(0,7)?"[email="+b.attr("href").substr(7)+"]"+c+"[/email]":"[url="+decodeURI(b.attr("href"))+"]"+c+"[/url]"},html:function(b,c,a){if("undefined"===typeof c.defaultAttr||0===c.defaultAttr.length)c.defaultAttr=a;return'<a href="'+encodeURI(c.defaultAttr)+'">'+a+"</a>"}},email:{html:function(b,c,a){"undefined"===typeof c.defaultAttr&&(c.defaultAttr=a);return'<a href="mailto:'+c.defaultAttr+'">'+a+"</a>"}},quote:{tags:{blockquote:null},isBlock:!0,format:function(b,
c){var a="";1===d(b).children("cite:first").length&&(a="="+d(b).children("cite:first").text(),d(b).children("cite:first").remove(),c=this.elementToBbcode(d(b)));return"[quote"+a+"]"+c+"[/quote]"},html:function(b,c,a){"undefined"!==typeof c.defaultAttr&&(a="<cite>"+c.defaultAttr+"</cite>"+a);return"<blockquote>"+a+"</blockquote>"}},code:{tags:{code:null},isBlock:!0,format:"[code]{0}[/code]",html:"<code>{0}</code>"},left:{styles:{"text-align":["left","-webkit-left","-moz-left","-khtml-left"]},isBlock:!0,
format:"[left]{0}[/left]",html:'<div align="left">{0}</div>'},center:{styles:{"text-align":["center","-webkit-center","-moz-center","-khtml-center"]},isBlock:!0,format:"[center]{0}[/center]",html:'<div align="center">{0}</div>'},right:{styles:{"text-align":["right","-webkit-right","-moz-right","-khtml-right"]},isBlock:!0,format:"[right]{0}[/right]",html:'<div align="right">{0}</div>'},justify:{styles:{"text-align":["justify","-webkit-justify","-moz-justify","-khtml-justify"]},isBlock:!0,format:"[justify]{0}[/justify]",
html:'<div align="justify">{0}</div>'},youtube:{tags:{iframe:{"data-youtube-id":null}},format:function(b,c){return!b.attr("data-youtube-id")?c:"[youtube]"+b.attr("data-youtube-id")+"[/youtube]"},html:'<iframe width="560" height="315" src="http://www.youtube.com/embed/{0}?wmode=opaque" data-youtube-id="{0}" frameborder="0" allowfullscreen></iframe>'},ignore:{}};d.sceditorBBCodePlugin.commandExists=function(b){return"undefined"!==typeof d.sceditorBBCodePlugin.bbcodes[b]};d.sceditorBBCodePlugin.setCommand=
function(b,c,a,f,e){if(!b||!f||!e)return!1;d.sceditorBBCodePlugin.commandExists(b)||(d.sceditorBBCodePlugin.bbcodes[b]={});d.sceditorBBCodePlugin.bbcodes[b].format=f;d.sceditorBBCodePlugin.bbcodes[b].html=e;c&&(d.sceditorBBCodePlugin.bbcodes[b].tags=c);a&&(d.sceditorBBCodePlugin.bbcodes[b].styles=a);return!0};d.fn.sceditorBBCodePlugin=function(b){return this.each(function(){new d.sceditorBBCodePlugin(this,b)})}})(jQuery);
